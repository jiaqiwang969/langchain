"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[35296],{3905:(e,n,t)=>{t.d(n,{Zo:()=>l,kt:()=>h});var r=t(67294);function a(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function i(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function o(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?i(Object(t),!0).forEach((function(n){a(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):i(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function d(e,n){if(null==e)return{};var t,r,a=function(e,n){if(null==e)return{};var t,r,a={},i=Object.keys(e);for(r=0;r<i.length;r++)t=i[r],n.indexOf(t)>=0||(a[t]=e[t]);return a}(e,n);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)t=i[r],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(a[t]=e[t])}return a}var c=r.createContext({}),s=function(e){var n=r.useContext(c),t=n;return e&&(t="function"==typeof e?e(n):o(o({},n),e)),t},l=function(e){var n=s(e.components);return r.createElement(c.Provider,{value:n},e.children)},m="mdxType",p={inlineCode:"code",wrapper:function(e){var n=e.children;return r.createElement(r.Fragment,{},n)}},u=r.forwardRef((function(e,n){var t=e.components,a=e.mdxType,i=e.originalType,c=e.parentName,l=d(e,["components","mdxType","originalType","parentName"]),m=s(t),u=a,h=m["".concat(c,".").concat(u)]||m[u]||p[u]||i;return t?r.createElement(h,o(o({ref:n},l),{},{components:t})):r.createElement(h,o({ref:n},l))}));function h(e,n){var t=arguments,a=n&&n.mdxType;if("string"==typeof e||a){var i=t.length,o=new Array(i);o[0]=u;var d={};for(var c in n)hasOwnProperty.call(n,c)&&(d[c]=n[c]);d.originalType=e,d[m]="string"==typeof e?e:a,o[1]=d;for(var s=2;s<i;s++)o[s]=t[s];return r.createElement.apply(null,o)}return r.createElement.apply(null,t)}u.displayName="MDXCreateElement"},47002:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>c,contentTitle:()=>o,default:()=>h,frontMatter:()=>i,metadata:()=>d,toc:()=>s});var r=t(87462),a=(t(67294),t(3905));const i={},o="DocArray Retriever",d={unversionedId:"integrations/retrievers/docarray_retriever",id:"integrations/retrievers/docarray_retriever",title:"DocArray Retriever",description:"DocArray is a versatile, open-source tool for managing your multi-modal data. It lets you shape your data however you want, and offers the flexibility to store and search it using various document index backends. Plus, it gets even better - you can utilize your DocArray document index to create a DocArrayRetriever, and build awesome Langchain apps!",source:"@site/docs/integrations/retrievers/docarray_retriever.md",sourceDirName:"integrations/retrievers",slug:"/integrations/retrievers/docarray_retriever",permalink:"/langchain/docs/integrations/retrievers/docarray_retriever",draft:!1,tags:[],version:"current",frontMatter:{},sidebar:"integrations",previous:{title:"Cohere Reranker",permalink:"/langchain/docs/integrations/retrievers/cohere-reranker"},next:{title:"ElasticSearch BM25",permalink:"/langchain/docs/integrations/retrievers/elastic_search_bm25"}},c={},s=[{value:"InMemoryExactNNIndex",id:"inmemoryexactnnindex",level:2},{value:"HnswDocumentIndex",id:"hnswdocumentindex",level:2},{value:"WeaviateDocumentIndex",id:"weaviatedocumentindex",level:2},{value:"ElasticDocIndex",id:"elasticdocindex",level:2},{value:"QdrantDocumentIndex",id:"qdrantdocumentindex",level:2},{value:"Normal Retriever",id:"normal-retriever",level:2},{value:"Retriever with Filters",id:"retriever-with-filters",level:2},{value:"Retriever with MMR search",id:"retriever-with-mmr-search",level:2}],l=(m="CodeOutputBlock",function(e){return console.warn("Component "+m+" was not imported, exported, or provided by MDXProvider as global scope"),(0,a.kt)("div",e)});var m;const p={toc:s},u="wrapper";function h(e){let{components:n,...t}=e;return(0,a.kt)(u,(0,r.Z)({},p,t,{components:n,mdxType:"MDXLayout"}),(0,a.kt)("h1",{id:"docarray-retriever"},"DocArray Retriever"),(0,a.kt)("p",null,(0,a.kt)("a",{parentName:"p",href:"https://github.com/docarray/docarray"},"DocArray")," is a versatile, open-source tool for managing your multi-modal data. It lets you shape your data however you want, and offers the flexibility to store and search it using various document index backends. Plus, it gets even better - you can utilize your DocArray document index to create a DocArrayRetriever, and build awesome Langchain apps!"),(0,a.kt)("p",null,"This notebook is split into two sections. The first section offers an introduction to all five supported document index backends. It provides guidance on setting up and indexing each backend, and also instructs you on how to build a DocArrayRetriever for finding relevant documents. In the second section, we'll select one of these backends and illustrate how to use it through a basic example."),(0,a.kt)("p",null,(0,a.kt)("a",{parentName:"p",href:"#Document-Index-Backends"},"Document Index Backends")),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("a",{parentName:"li",href:"#inmemoryexactnnindex"},"InMemoryExactNNIndex")),(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("a",{parentName:"li",href:"#hnswdocumentindex"},"HnswDocumentIndex")),(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("a",{parentName:"li",href:"#weaviatedocumentindex"},"WeaviateDocumentIndex")),(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("a",{parentName:"li",href:"#elasticdocindex"},"ElasticDocIndex")),(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("a",{parentName:"li",href:"#qdrantdocumentindex"},"QdrantDocumentIndex"))),(0,a.kt)("p",null,(0,a.kt)("a",{parentName:"p",href:"#Movie-Retrieval-using-HnswDocumentIndex"},"Movie Retrieval using HnswDocumentIndex")),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"#normal-retriever"},"Normal Retriever")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"#retriever-with-filters"},"Retriever with Filters")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"#Retriever-with-MMR-search"},"Retriever with MMR Search"))),(0,a.kt)("h1",{id:"document-index-backends"},"Document Index Backends"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-python"},'\x3c!--IMPORTS:[{"imported": "DocArrayRetriever", "source": "langchain.retrievers", "docs": "https://api.python.langchain.com/en/latest/retrievers/langchain.retrievers.docarray.DocArrayRetriever.html", "title": "DocArray Retriever"}, {"imported": "FakeEmbeddings", "source": "langchain.embeddings", "docs": "https://api.python.langchain.com/en/latest/embeddings/langchain.embeddings.fake.FakeEmbeddings.html", "title": "DocArray Retriever"}]--\x3e\nfrom langchain.retrievers import DocArrayRetriever\nfrom docarray import BaseDoc\nfrom docarray.typing import NdArray\nimport numpy as np\nfrom langchain.embeddings import FakeEmbeddings\nimport random\n\nembeddings = FakeEmbeddings(size=32)\n')),(0,a.kt)("p",null,"Before you start building the index, it's important to define your document schema. This determines what fields your documents will have and what type of data each field will hold."),(0,a.kt)("p",null,"For this demonstration, we'll create a somewhat random schema containing 'title' (str), 'title_embedding' (numpy array), 'year' (int), and 'color' (str)"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-python"},"class MyDoc(BaseDoc):\n    title: str\n    title_embedding: NdArray[32]\n    year: int\n    color: str\n")),(0,a.kt)("h2",{id:"inmemoryexactnnindex"},"InMemoryExactNNIndex"),(0,a.kt)("p",null,"InMemoryExactNNIndex stores all Documentsin memory. It is a great starting point for small datasets, where you may not want to launch a database server."),(0,a.kt)("p",null,"Learn more here: ",(0,a.kt)("a",{parentName:"p",href:"https://docs.docarray.org/user_guide/storing/index_in_memory/"},"https://docs.docarray.org/user_guide/storing/index_in_memory/")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-python"},'from docarray.index import InMemoryExactNNIndex\n\n\n# initialize the index\ndb = InMemoryExactNNIndex[MyDoc]()\n# index data\ndb.index(\n    [\n        MyDoc(\n            title=f"My document {i}",\n            title_embedding=embeddings.embed_query(f"query {i}"),\n            year=i,\n            color=random.choice(["red", "green", "blue"]),\n        )\n        for i in range(100)\n    ]\n)\n# optionally, you can create a filter query\nfilter_query = {"year": {"$lte": 90}}\n')),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-python"},'# create a retriever\nretriever = DocArrayRetriever(\n    index=db,\n    embeddings=embeddings,\n    search_field="title_embedding",\n    content_field="title",\n    filters=filter_query,\n)\n\n# find the relevant document\ndoc = retriever.get_relevant_documents("some query")\nprint(doc)\n')),(0,a.kt)(l,{lang:"python",mdxType:"CodeOutputBlock"},(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"    [Document(page_content='My document 56', metadata={'id': '1f33e58b6468ab722f3786b96b20afe6', 'year': 56, 'color': 'red'})]\n"))),(0,a.kt)("h2",{id:"hnswdocumentindex"},"HnswDocumentIndex"),(0,a.kt)("p",null,"HnswDocumentIndex is a lightweight Document Index implementation that runs fully locally and is best suited for small- to medium-sized datasets. It stores vectors on disk in ",(0,a.kt)("a",{parentName:"p",href:"https://github.com/nmslib/hnswlib"},"hnswlib"),", and stores all other data in ",(0,a.kt)("a",{parentName:"p",href:"https://www.sqlite.org/index.html"},"SQLite"),"."),(0,a.kt)("p",null,"Learn more here: ",(0,a.kt)("a",{parentName:"p",href:"https://docs.docarray.org/user_guide/storing/index_hnswlib/"},"https://docs.docarray.org/user_guide/storing/index_hnswlib/")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-python"},'from docarray.index import HnswDocumentIndex\n\n\n# initialize the index\ndb = HnswDocumentIndex[MyDoc](work_dir="hnsw_index")\n\n# index data\ndb.index(\n    [\n        MyDoc(\n            title=f"My document {i}",\n            title_embedding=embeddings.embed_query(f"query {i}"),\n            year=i,\n            color=random.choice(["red", "green", "blue"]),\n        )\n        for i in range(100)\n    ]\n)\n# optionally, you can create a filter query\nfilter_query = {"year": {"$lte": 90}}\n')),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-python"},'# create a retriever\nretriever = DocArrayRetriever(\n    index=db,\n    embeddings=embeddings,\n    search_field="title_embedding",\n    content_field="title",\n    filters=filter_query,\n)\n\n# find the relevant document\ndoc = retriever.get_relevant_documents("some query")\nprint(doc)\n')),(0,a.kt)(l,{lang:"python",mdxType:"CodeOutputBlock"},(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"    [Document(page_content='My document 28', metadata={'id': 'ca9f3f4268eec7c97a7d6e77f541cb82', 'year': 28, 'color': 'red'})]\n"))),(0,a.kt)("h2",{id:"weaviatedocumentindex"},"WeaviateDocumentIndex"),(0,a.kt)("p",null,"WeaviateDocumentIndex is a document index that is built upon ",(0,a.kt)("a",{parentName:"p",href:"https://weaviate.io/"},"Weaviate")," vector database."),(0,a.kt)("p",null,"Learn more here: ",(0,a.kt)("a",{parentName:"p",href:"https://docs.docarray.org/user_guide/storing/index_weaviate/"},"https://docs.docarray.org/user_guide/storing/index_weaviate/")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-python"},"# There's a small difference with the Weaviate backend compared to the others.\n# Here, you need to 'mark' the field used for vector search with 'is_embedding=True'.\n# So, let's create a new schema for Weaviate that takes care of this requirement.\n\nfrom pydantic import Field\n\n\nclass WeaviateDoc(BaseDoc):\n    title: str\n    title_embedding: NdArray[32] = Field(is_embedding=True)\n    year: int\n    color: str\n")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-python"},'from docarray.index import WeaviateDocumentIndex\n\n\n# initialize the index\ndbconfig = WeaviateDocumentIndex.DBConfig(host="http://localhost:8080")\ndb = WeaviateDocumentIndex[WeaviateDoc](db_config=dbconfig)\n\n# index data\ndb.index(\n    [\n        MyDoc(\n            title=f"My document {i}",\n            title_embedding=embeddings.embed_query(f"query {i}"),\n            year=i,\n            color=random.choice(["red", "green", "blue"]),\n        )\n        for i in range(100)\n    ]\n)\n# optionally, you can create a filter query\nfilter_query = {"path": ["year"], "operator": "LessThanEqual", "valueInt": "90"}\n')),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-python"},'# create a retriever\nretriever = DocArrayRetriever(\n    index=db,\n    embeddings=embeddings,\n    search_field="title_embedding",\n    content_field="title",\n    filters=filter_query,\n)\n\n# find the relevant document\ndoc = retriever.get_relevant_documents("some query")\nprint(doc)\n')),(0,a.kt)(l,{lang:"python",mdxType:"CodeOutputBlock"},(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"    [Document(page_content='My document 17', metadata={'id': '3a5b76e85f0d0a01785dc8f9d965ce40', 'year': 17, 'color': 'red'})]\n"))),(0,a.kt)("h2",{id:"elasticdocindex"},"ElasticDocIndex"),(0,a.kt)("p",null,"ElasticDocIndex is a document index that is built upon ",(0,a.kt)("a",{parentName:"p",href:"https://github.com/elastic/elasticsearch"},"ElasticSearch")),(0,a.kt)("p",null,"Learn more here: ",(0,a.kt)("a",{parentName:"p",href:"https://docs.docarray.org/user_guide/storing/index_elastic/"},"https://docs.docarray.org/user_guide/storing/index_elastic/")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-python"},'from docarray.index import ElasticDocIndex\n\n\n# initialize the index\ndb = ElasticDocIndex[MyDoc](\n    hosts="http://localhost:9200", index_name="docarray_retriever"\n)\n\n# index data\ndb.index(\n    [\n        MyDoc(\n            title=f"My document {i}",\n            title_embedding=embeddings.embed_query(f"query {i}"),\n            year=i,\n            color=random.choice(["red", "green", "blue"]),\n        )\n        for i in range(100)\n    ]\n)\n# optionally, you can create a filter query\nfilter_query = {"range": {"year": {"lte": 90}}}\n')),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-python"},'# create a retriever\nretriever = DocArrayRetriever(\n    index=db,\n    embeddings=embeddings,\n    search_field="title_embedding",\n    content_field="title",\n    filters=filter_query,\n)\n\n# find the relevant document\ndoc = retriever.get_relevant_documents("some query")\nprint(doc)\n')),(0,a.kt)(l,{lang:"python",mdxType:"CodeOutputBlock"},(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"    [Document(page_content='My document 46', metadata={'id': 'edbc721bac1c2ad323414ad1301528a4', 'year': 46, 'color': 'green'})]\n"))),(0,a.kt)("h2",{id:"qdrantdocumentindex"},"QdrantDocumentIndex"),(0,a.kt)("p",null,"QdrantDocumentIndex is a document index that is build upon ",(0,a.kt)("a",{parentName:"p",href:"https://qdrant.tech/"},"Qdrant")," vector database"),(0,a.kt)("p",null,"Learn more here: ",(0,a.kt)("a",{parentName:"p",href:"https://docs.docarray.org/user_guide/storing/index_qdrant/"},"https://docs.docarray.org/user_guide/storing/index_qdrant/")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-python"},'from docarray.index import QdrantDocumentIndex\nfrom qdrant_client.http import models as rest\n\n\n# initialize the index\nqdrant_config = QdrantDocumentIndex.DBConfig(path=":memory:")\ndb = QdrantDocumentIndex[MyDoc](qdrant_config)\n\n# index data\ndb.index(\n    [\n        MyDoc(\n            title=f"My document {i}",\n            title_embedding=embeddings.embed_query(f"query {i}"),\n            year=i,\n            color=random.choice(["red", "green", "blue"]),\n        )\n        for i in range(100)\n    ]\n)\n# optionally, you can create a filter query\nfilter_query = rest.Filter(\n    must=[\n        rest.FieldCondition(\n            key="year",\n            range=rest.Range(\n                gte=10,\n                lt=90,\n            ),\n        )\n    ]\n)\n')),(0,a.kt)(l,{lang:"python",mdxType:"CodeOutputBlock"},(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"    WARNING:root:Payload indexes have no effect in the local Qdrant. Please use server Qdrant if you need payload indexes.\n"))),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-python"},'# create a retriever\nretriever = DocArrayRetriever(\n    index=db,\n    embeddings=embeddings,\n    search_field="title_embedding",\n    content_field="title",\n    filters=filter_query,\n)\n\n# find the relevant document\ndoc = retriever.get_relevant_documents("some query")\nprint(doc)\n')),(0,a.kt)(l,{lang:"python",mdxType:"CodeOutputBlock"},(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"    [Document(page_content='My document 80', metadata={'id': '97465f98d0810f1f330e4ecc29b13d20', 'year': 80, 'color': 'blue'})]\n"))),(0,a.kt)("h1",{id:"movie-retrieval-using-hnswdocumentindex"},"Movie Retrieval using HnswDocumentIndex"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-python"},'movies = [\n    {\n        "title": "Inception",\n        "description": "A thief who steals corporate secrets through the use of dream-sharing technology is given the task of planting an idea into the mind of a CEO.",\n        "director": "Christopher Nolan",\n        "rating": 8.8,\n    },\n    {\n        "title": "The Dark Knight",\n        "description": "When the menace known as the Joker wreaks havoc and chaos on the people of Gotham, Batman must accept one of the greatest psychological and physical tests of his ability to fight injustice.",\n        "director": "Christopher Nolan",\n        "rating": 9.0,\n    },\n    {\n        "title": "Interstellar",\n        "description": "Interstellar explores the boundaries of human exploration as a group of astronauts venture through a wormhole in space. In their quest to ensure the survival of humanity, they confront the vastness of space-time and grapple with love and sacrifice.",\n        "director": "Christopher Nolan",\n        "rating": 8.6,\n    },\n    {\n        "title": "Pulp Fiction",\n        "description": "The lives of two mob hitmen, a boxer, a gangster\'s wife, and a pair of diner bandits intertwine in four tales of violence and redemption.",\n        "director": "Quentin Tarantino",\n        "rating": 8.9,\n    },\n    {\n        "title": "Reservoir Dogs",\n        "description": "When a simple jewelry heist goes horribly wrong, the surviving criminals begin to suspect that one of them is a police informant.",\n        "director": "Quentin Tarantino",\n        "rating": 8.3,\n    },\n    {\n        "title": "The Godfather",\n        "description": "An aging patriarch of an organized crime dynasty transfers control of his empire to his reluctant son.",\n        "director": "Francis Ford Coppola",\n        "rating": 9.2,\n    },\n]\n')),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-python"},'import getpass\nimport os\n\nos.environ["OPENAI_API_KEY"] = getpass.getpass("OpenAI API Key:")\n')),(0,a.kt)(l,{lang:"python",mdxType:"CodeOutputBlock"},(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"    OpenAI API Key: \xb7\xb7\xb7\xb7\xb7\xb7\xb7\xb7\n"))),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-python"},'\x3c!--IMPORTS:[{"imported": "OpenAIEmbeddings", "source": "langchain.embeddings.openai", "docs": "https://api.python.langchain.com/en/latest/embeddings/langchain.embeddings.openai.OpenAIEmbeddings.html", "title": "DocArray Retriever"}]--\x3e\nfrom docarray import BaseDoc, DocList\nfrom docarray.typing import NdArray\nfrom langchain.embeddings.openai import OpenAIEmbeddings\n\n\n# define schema for your movie documents\nclass MyDoc(BaseDoc):\n    title: str\n    description: str\n    description_embedding: NdArray[1536]\n    rating: float\n    director: str\n\n\nembeddings = OpenAIEmbeddings()\n\n\n# get "description" embeddings, and create documents\ndocs = DocList[MyDoc](\n    [\n        MyDoc(\n            description_embedding=embeddings.embed_query(movie["description"]), **movie\n        )\n        for movie in movies\n    ]\n)\n')),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-python"},'from docarray.index import HnswDocumentIndex\n\n# initialize the index\ndb = HnswDocumentIndex[MyDoc](work_dir="movie_search")\n\n# add data\ndb.index(docs)\n')),(0,a.kt)("h2",{id:"normal-retriever"},"Normal Retriever"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-python"},'\x3c!--IMPORTS:[{"imported": "DocArrayRetriever", "source": "langchain.retrievers", "docs": "https://api.python.langchain.com/en/latest/retrievers/langchain.retrievers.docarray.DocArrayRetriever.html", "title": "DocArray Retriever"}]--\x3e\nfrom langchain.retrievers import DocArrayRetriever\n\n# create a retriever\nretriever = DocArrayRetriever(\n    index=db,\n    embeddings=embeddings,\n    search_field="description_embedding",\n    content_field="description",\n)\n\n# find the relevant document\ndoc = retriever.get_relevant_documents("movie about dreams")\nprint(doc)\n')),(0,a.kt)(l,{lang:"python",mdxType:"CodeOutputBlock"},(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"    [Document(page_content='A thief who steals corporate secrets through the use of dream-sharing technology is given the task of planting an idea into the mind of a CEO.', metadata={'id': 'f1649d5b6776db04fec9a116bbb6bbe5', 'title': 'Inception', 'rating': 8.8, 'director': 'Christopher Nolan'})]\n"))),(0,a.kt)("h2",{id:"retriever-with-filters"},"Retriever with Filters"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-python"},'\x3c!--IMPORTS:[{"imported": "DocArrayRetriever", "source": "langchain.retrievers", "docs": "https://api.python.langchain.com/en/latest/retrievers/langchain.retrievers.docarray.DocArrayRetriever.html", "title": "DocArray Retriever"}]--\x3e\nfrom langchain.retrievers import DocArrayRetriever\n\n# create a retriever\nretriever = DocArrayRetriever(\n    index=db,\n    embeddings=embeddings,\n    search_field="description_embedding",\n    content_field="description",\n    filters={"director": {"$eq": "Christopher Nolan"}},\n    top_k=2,\n)\n\n# find relevant documents\ndocs = retriever.get_relevant_documents("space travel")\nprint(docs)\n')),(0,a.kt)(l,{lang:"python",mdxType:"CodeOutputBlock"},(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"    [Document(page_content='Interstellar explores the boundaries of human exploration as a group of astronauts venture through a wormhole in space. In their quest to ensure the survival of humanity, they confront the vastness of space-time and grapple with love and sacrifice.', metadata={'id': 'ab704cc7ae8573dc617f9a5e25df022a', 'title': 'Interstellar', 'rating': 8.6, 'director': 'Christopher Nolan'}), Document(page_content='A thief who steals corporate secrets through the use of dream-sharing technology is given the task of planting an idea into the mind of a CEO.', metadata={'id': 'f1649d5b6776db04fec9a116bbb6bbe5', 'title': 'Inception', 'rating': 8.8, 'director': 'Christopher Nolan'})]\n"))),(0,a.kt)("h2",{id:"retriever-with-mmr-search"},"Retriever with MMR search"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-python"},'\x3c!--IMPORTS:[{"imported": "DocArrayRetriever", "source": "langchain.retrievers", "docs": "https://api.python.langchain.com/en/latest/retrievers/langchain.retrievers.docarray.DocArrayRetriever.html", "title": "DocArray Retriever"}]--\x3e\nfrom langchain.retrievers import DocArrayRetriever\n\n# create a retriever\nretriever = DocArrayRetriever(\n    index=db,\n    embeddings=embeddings,\n    search_field="description_embedding",\n    content_field="description",\n    filters={"rating": {"$gte": 8.7}},\n    search_type="mmr",\n    top_k=3,\n)\n\n# find relevant documents\ndocs = retriever.get_relevant_documents("action movies")\nprint(docs)\n')),(0,a.kt)(l,{lang:"python",mdxType:"CodeOutputBlock"},(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"    [Document(page_content=\"The lives of two mob hitmen, a boxer, a gangster's wife, and a pair of diner bandits intertwine in four tales of violence and redemption.\", metadata={'id': 'e6aa313bbde514e23fbc80ab34511afd', 'title': 'Pulp Fiction', 'rating': 8.9, 'director': 'Quentin Tarantino'}), Document(page_content='A thief who steals corporate secrets through the use of dream-sharing technology is given the task of planting an idea into the mind of a CEO.', metadata={'id': 'f1649d5b6776db04fec9a116bbb6bbe5', 'title': 'Inception', 'rating': 8.8, 'director': 'Christopher Nolan'}), Document(page_content='When the menace known as the Joker wreaks havoc and chaos on the people of Gotham, Batman must accept one of the greatest psychological and physical tests of his ability to fight injustice.', metadata={'id': '91dec17d4272041b669fd113333a65f7', 'title': 'The Dark Knight', 'rating': 9.0, 'director': 'Christopher Nolan'})]\n"))))}h.isMDXComponent=!0}}]);