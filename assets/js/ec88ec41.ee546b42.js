"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[69863],{3905:(e,t,n)=>{n.d(t,{Zo:()=>i,kt:()=>h});var r=n(67294);function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var p=r.createContext({}),c=function(e){var t=r.useContext(p),n=t;return e&&(n="function"==typeof e?e(t):s(s({},t),e)),n},i=function(e){var t=c(e.components);return r.createElement(p.Provider,{value:t},e.children)},u="mdxType",m={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},d=r.forwardRef((function(e,t){var n=e.components,o=e.mdxType,a=e.originalType,p=e.parentName,i=l(e,["components","mdxType","originalType","parentName"]),u=c(n),d=o,h=u["".concat(p,".").concat(d)]||u[d]||m[d]||a;return n?r.createElement(h,s(s({ref:t},i),{},{components:n})):r.createElement(h,s({ref:t},i))}));function h(e,t){var n=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var a=n.length,s=new Array(a);s[0]=d;var l={};for(var p in t)hasOwnProperty.call(t,p)&&(l[p]=t[p]);l.originalType=e,l[u]="string"==typeof e?e:o,s[1]=l;for(var c=2;c<a;c++)s[c]=n[c];return r.createElement.apply(null,s)}return r.createElement.apply(null,n)}d.displayName="MDXCreateElement"},50884:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>p,contentTitle:()=>s,default:()=>h,frontMatter:()=>a,metadata:()=>l,toc:()=>c});var r=n(87462),o=(n(67294),n(3905));const a={},s="Program-aided language model (PAL) chain",l={unversionedId:"use_cases/more/code_writing/pal",id:"use_cases/more/code_writing/pal",title:"Program-aided language model (PAL) chain",description:"Implements Program-Aided Language Models, as in https://arxiv.org/pdf/2211.10435.pdf.",source:"@site/docs/use_cases/more/code_writing/pal.md",sourceDirName:"use_cases/more/code_writing",slug:"/use_cases/more/code_writing/pal",permalink:"/langchain/docs/use_cases/more/code_writing/pal",draft:!1,tags:[],version:"current",frontMatter:{},sidebar:"use_cases",previous:{title:"LLM Symbolic Math",permalink:"/langchain/docs/use_cases/more/code_writing/llm_symbolic_math"},next:{title:"Analyzing graph data",permalink:"/langchain/docs/use_cases/more/graph/"}},p={},c=[{value:"Math Prompt",id:"math-prompt",level:2},{value:"Colored Objects",id:"colored-objects",level:2},{value:"Intermediate Steps",id:"intermediate-steps",level:2}],i=(u="CodeOutputBlock",function(e){return console.warn("Component "+u+" was not imported, exported, or provided by MDXProvider as global scope"),(0,o.kt)("div",e)});var u;const m={toc:c},d="wrapper";function h(e){let{components:t,...n}=e;return(0,o.kt)(d,(0,r.Z)({},m,n,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("h1",{id:"program-aided-language-model-pal-chain"},"Program-aided language model (PAL) chain"),(0,o.kt)("p",null,"Implements Program-Aided Language Models, as in ",(0,o.kt)("a",{parentName:"p",href:"https://arxiv.org/pdf/2211.10435.pdf"},"https://arxiv.org/pdf/2211.10435.pdf"),"."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-python"},"from langchain_experimental.pal_chain import PALChain\nfrom langchain import OpenAI\n")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-python"},"llm = OpenAI(temperature=0, max_tokens=512)\n")),(0,o.kt)("h2",{id:"math-prompt"},"Math Prompt"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-python"},"pal_chain = PALChain.from_math_prompt(llm, verbose=True)\n")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-python"},'question = "Jan has three times the number of pets as Marcia. Marcia has two more pets than Cindy. If Cindy has four pets, how many total pets do the three have?"\n')),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-python"},"pal_chain.run(question)\n")),(0,o.kt)(i,{lang:"python",mdxType:"CodeOutputBlock"},(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},'    \n    \n    > Entering new PALChain chain...\n    def solution():\n        """Jan has three times the number of pets as Marcia. Marcia has two more pets than Cindy. If Cindy has four pets, how many total pets do the three have?"""\n        cindy_pets = 4\n        marcia_pets = cindy_pets + 2\n        jan_pets = marcia_pets * 3\n        total_pets = cindy_pets + marcia_pets + jan_pets\n        result = total_pets\n        return result\n    \n    > Finished chain.\n\n\n\n\n\n    \'28\'\n'))),(0,o.kt)("h2",{id:"colored-objects"},"Colored Objects"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-python"},"pal_chain = PALChain.from_colored_object_prompt(llm, verbose=True)\n")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-python"},'question = "On the desk, you see two blue booklets, two purple booklets, and two yellow pairs of sunglasses. If I remove all the pairs of sunglasses from the desk, how many purple items remain on it?"\n')),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-python"},"pal_chain.run(question)\n")),(0,o.kt)(i,{lang:"python",mdxType:"CodeOutputBlock"},(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"    \n    \n    > Entering new PALChain chain...\n    # Put objects into a list to record ordering\n    objects = []\n    objects += [('booklet', 'blue')] * 2\n    objects += [('booklet', 'purple')] * 2\n    objects += [('sunglasses', 'yellow')] * 2\n    \n    # Remove all pairs of sunglasses\n    objects = [object for object in objects if object[0] != 'sunglasses']\n    \n    # Count number of purple objects\n    num_purple = len([object for object in objects if object[1] == 'purple'])\n    answer = num_purple\n    \n    > Finished PALChain chain.\n\n\n\n\n\n    '2'\n"))),(0,o.kt)("h2",{id:"intermediate-steps"},"Intermediate Steps"),(0,o.kt)("p",null,"You can also use the intermediate steps flag to return the code executed that generates the answer."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-python"},"pal_chain = PALChain.from_colored_object_prompt(\n    llm, verbose=True, return_intermediate_steps=True\n)\n")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-python"},'question = "On the desk, you see two blue booklets, two purple booklets, and two yellow pairs of sunglasses. If I remove all the pairs of sunglasses from the desk, how many purple items remain on it?"\n')),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-python"},'result = pal_chain({"question": question})\n')),(0,o.kt)(i,{lang:"python",mdxType:"CodeOutputBlock"},(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"    \n    \n    > Entering new PALChain chain...\n    # Put objects into a list to record ordering\n    objects = []\n    objects += [('booklet', 'blue')] * 2\n    objects += [('booklet', 'purple')] * 2\n    objects += [('sunglasses', 'yellow')] * 2\n    \n    # Remove all pairs of sunglasses\n    objects = [object for object in objects if object[0] != 'sunglasses']\n    \n    # Count number of purple objects\n    num_purple = len([object for object in objects if object[1] == 'purple'])\n    answer = num_purple\n    \n    > Finished chain.\n"))),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-python"},'result["intermediate_steps"]\n')),(0,o.kt)(i,{lang:"python",mdxType:"CodeOutputBlock"},(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"    \"# Put objects into a list to record ordering\\nobjects = []\\nobjects += [('booklet', 'blue')] * 2\\nobjects += [('booklet', 'purple')] * 2\\nobjects += [('sunglasses', 'yellow')] * 2\\n\\n# Remove all pairs of sunglasses\\nobjects = [object for object in objects if object[0] != 'sunglasses']\\n\\n# Count number of purple objects\\nnum_purple = len([object for object in objects if object[1] == 'purple'])\\nanswer = num_purple\"\n"))))}h.isMDXComponent=!0}}]);