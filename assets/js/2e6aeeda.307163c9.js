"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[14027],{3905:(t,n,e)=>{e.d(n,{Zo:()=>u,kt:()=>h});var o=e(67294);function a(t,n,e){return n in t?Object.defineProperty(t,n,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[n]=e,t}function r(t,n){var e=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(t,n).enumerable}))),e.push.apply(e,o)}return e}function s(t){for(var n=1;n<arguments.length;n++){var e=null!=arguments[n]?arguments[n]:{};n%2?r(Object(e),!0).forEach((function(n){a(t,n,e[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(e)):r(Object(e)).forEach((function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(e,n))}))}return t}function i(t,n){if(null==t)return{};var e,o,a=function(t,n){if(null==t)return{};var e,o,a={},r=Object.keys(t);for(o=0;o<r.length;o++)e=r[o],n.indexOf(e)>=0||(a[e]=t[e]);return a}(t,n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);for(o=0;o<r.length;o++)e=r[o],n.indexOf(e)>=0||Object.prototype.propertyIsEnumerable.call(t,e)&&(a[e]=t[e])}return a}var l=o.createContext({}),c=function(t){var n=o.useContext(l),e=n;return t&&(e="function"==typeof t?t(n):s(s({},n),t)),e},u=function(t){var n=c(t.components);return o.createElement(l.Provider,{value:n},t.children)},p="mdxType",g={inlineCode:"code",wrapper:function(t){var n=t.children;return o.createElement(o.Fragment,{},n)}},m=o.forwardRef((function(t,n){var e=t.components,a=t.mdxType,r=t.originalType,l=t.parentName,u=i(t,["components","mdxType","originalType","parentName"]),p=c(e),m=a,h=p["".concat(l,".").concat(m)]||p[m]||g[m]||r;return e?o.createElement(h,s(s({ref:n},u),{},{components:e})):o.createElement(h,s({ref:n},u))}));function h(t,n){var e=arguments,a=n&&n.mdxType;if("string"==typeof t||a){var r=e.length,s=new Array(r);s[0]=m;var i={};for(var l in n)hasOwnProperty.call(n,l)&&(i[l]=n[l]);i.originalType=t,i[p]="string"==typeof t?t:a,s[1]=i;for(var c=2;c<r;c++)s[c]=e[c];return o.createElement.apply(null,s)}return o.createElement.apply(null,e)}m.displayName="MDXCreateElement"},40575:(t,n,e)=>{e.r(n),e.d(n,{assets:()=>l,contentTitle:()=>s,default:()=>h,frontMatter:()=>r,metadata:()=>i,toc:()=>c});var o=e(87462),a=(e(67294),e(3905));const r={},s="Custom multi-action agent",i={unversionedId:"modules/agents/how_to/custom_multi_action_agent",id:"modules/agents/how_to/custom_multi_action_agent",title:"Custom multi-action agent",description:"This notebook goes through how to create your own custom agent.",source:"@site/docs/modules/agents/how_to/custom_multi_action_agent.md",sourceDirName:"modules/agents/how_to",slug:"/modules/agents/how_to/custom_multi_action_agent",permalink:"/langchain/docs/modules/agents/how_to/custom_multi_action_agent",draft:!1,tags:[],version:"current",frontMatter:{},sidebar:"docs",previous:{title:"Custom MRKL agent",permalink:"/langchain/docs/modules/agents/how_to/custom_mrkl_agent"},next:{title:"Handle parsing errors",permalink:"/langchain/docs/modules/agents/how_to/handle_parsing_errors"}},l={},c=[],u=(p="CodeOutputBlock",function(t){return console.warn("Component "+p+" was not imported, exported, or provided by MDXProvider as global scope"),(0,a.kt)("div",t)});var p;const g={toc:c},m="wrapper";function h(t){let{components:n,...e}=t;return(0,a.kt)(m,(0,o.Z)({},g,e,{components:n,mdxType:"MDXLayout"}),(0,a.kt)("h1",{id:"custom-multi-action-agent"},"Custom multi-action agent"),(0,a.kt)("p",null,"This notebook goes through how to create your own custom agent."),(0,a.kt)("p",null,"An agent consists of two parts:"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"Tools: The tools the agent has available to use."),(0,a.kt)("li",{parentName:"ul"},"The agent class itself: this decides which action to take.")),(0,a.kt)("p",null,"In this notebook we walk through how to create a custom agent that predicts/takes multiple steps at a time."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-python"},'\x3c!--IMPORTS:[{"imported": "Tool", "source": "langchain.agents", "docs": "https://api.python.langchain.com/en/latest/tools/langchain.tools.base.Tool.html", "title": "Custom multi-action agent"}, {"imported": "AgentExecutor", "source": "langchain.agents", "docs": "https://api.python.langchain.com/en/latest/agents/langchain.agents.agent.AgentExecutor.html", "title": "Custom multi-action agent"}, {"imported": "BaseMultiActionAgent", "source": "langchain.agents", "docs": "https://api.python.langchain.com/en/latest/agents/langchain.agents.agent.BaseMultiActionAgent.html", "title": "Custom multi-action agent"}]--\x3e\nfrom langchain.agents import Tool, AgentExecutor, BaseMultiActionAgent\nfrom langchain import OpenAI, SerpAPIWrapper\n')),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-python"},'def random_word(query: str) -> str:\n    print("\\nNow I\'m doing this!")\n    return "foo"\n')),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-python"},'search = SerpAPIWrapper()\ntools = [\n    Tool(\n        name="Search",\n        func=search.run,\n        description="useful for when you need to answer questions about current events",\n    ),\n    Tool(\n        name="RandomWord",\n        func=random_word,\n        description="call this to get a random word.",\n    ),\n]\n')),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-python"},'\x3c!--IMPORTS:[{"imported": "AgentAction", "source": "langchain.schema", "docs": "https://api.python.langchain.com/en/latest/schema/langchain.schema.agent.AgentAction.html", "title": "Custom multi-action agent"}, {"imported": "AgentFinish", "source": "langchain.schema", "docs": "https://api.python.langchain.com/en/latest/schema/langchain.schema.agent.AgentFinish.html", "title": "Custom multi-action agent"}]--\x3e\nfrom typing import List, Tuple, Any, Union\nfrom langchain.schema import AgentAction, AgentFinish\n\n\nclass FakeAgent(BaseMultiActionAgent):\n    """Fake Custom Agent."""\n\n    @property\n    def input_keys(self):\n        return ["input"]\n\n    def plan(\n        self, intermediate_steps: List[Tuple[AgentAction, str]], **kwargs: Any\n    ) -> Union[List[AgentAction], AgentFinish]:\n        """Given input, decided what to do.\n\n        Args:\n            intermediate_steps: Steps the LLM has taken to date,\n                along with observations\n            **kwargs: User inputs.\n\n        Returns:\n            Action specifying what tool to use.\n        """\n        if len(intermediate_steps) == 0:\n            return [\n                AgentAction(tool="Search", tool_input=kwargs["input"], log=""),\n                AgentAction(tool="RandomWord", tool_input=kwargs["input"], log=""),\n            ]\n        else:\n            return AgentFinish(return_values={"output": "bar"}, log="")\n\n    async def aplan(\n        self, intermediate_steps: List[Tuple[AgentAction, str]], **kwargs: Any\n    ) -> Union[List[AgentAction], AgentFinish]:\n        """Given input, decided what to do.\n\n        Args:\n            intermediate_steps: Steps the LLM has taken to date,\n                along with observations\n            **kwargs: User inputs.\n\n        Returns:\n            Action specifying what tool to use.\n        """\n        if len(intermediate_steps) == 0:\n            return [\n                AgentAction(tool="Search", tool_input=kwargs["input"], log=""),\n                AgentAction(tool="RandomWord", tool_input=kwargs["input"], log=""),\n            ]\n        else:\n            return AgentFinish(return_values={"output": "bar"}, log="")\n')),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-python"},"agent = FakeAgent()\n")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-python"},"agent_executor = AgentExecutor.from_agent_and_tools(\n    agent=agent, tools=tools, verbose=True\n)\n")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-python"},'agent_executor.run("How many people live in canada as of 2023?")\n')),(0,a.kt)(u,{lang:"python",mdxType:"CodeOutputBlock"},(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"    \n    \n    > Entering new AgentExecutor chain...\n    The current population of Canada is 38,669,152 as of Monday, April 24, 2023, based on Worldometer elaboration of the latest United Nations data.\n    Now I'm doing this!\n    foo\n    \n    > Finished chain.\n\n\n\n\n\n    'bar'\n"))))}h.isMDXComponent=!0}}]);