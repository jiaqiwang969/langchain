"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[24730],{3905:(e,n,t)=>{t.d(n,{Zo:()=>i,kt:()=>g});var a=t(67294);function o(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function r(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);n&&(a=a.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,a)}return t}function l(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?r(Object(t),!0).forEach((function(n){o(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):r(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function s(e,n){if(null==e)return{};var t,a,o=function(e,n){if(null==e)return{};var t,a,o={},r=Object.keys(e);for(a=0;a<r.length;a++)t=r[a],n.indexOf(t)>=0||(o[t]=e[t]);return o}(e,n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)t=r[a],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(o[t]=e[t])}return o}var c=a.createContext({}),p=function(e){var n=a.useContext(c),t=n;return e&&(t="function"==typeof e?e(n):l(l({},n),e)),t},i=function(e){var n=p(e.components);return a.createElement(c.Provider,{value:n},e.children)},u="mdxType",d={inlineCode:"code",wrapper:function(e){var n=e.children;return a.createElement(a.Fragment,{},n)}},m=a.forwardRef((function(e,n){var t=e.components,o=e.mdxType,r=e.originalType,c=e.parentName,i=s(e,["components","mdxType","originalType","parentName"]),u=p(t),m=o,g=u["".concat(c,".").concat(m)]||u[m]||d[m]||r;return t?a.createElement(g,l(l({ref:n},i),{},{components:t})):a.createElement(g,l({ref:n},i))}));function g(e,n){var t=arguments,o=n&&n.mdxType;if("string"==typeof e||o){var r=t.length,l=new Array(r);l[0]=m;var s={};for(var c in n)hasOwnProperty.call(n,c)&&(s[c]=n[c]);s.originalType=e,s[u]="string"==typeof e?e:o,l[1]=s;for(var p=2;p<r;p++)l[p]=t[p];return a.createElement.apply(null,l)}return a.createElement.apply(null,t)}m.displayName="MDXCreateElement"},38934:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>c,contentTitle:()=>l,default:()=>g,frontMatter:()=>r,metadata:()=>s,toc:()=>p});var a=t(87462),o=(t(67294),t(3905));const r={},l="Source Code",s={unversionedId:"integrations/document_loaders/source_code",id:"integrations/document_loaders/source_code",title:"Source Code",description:"This notebook covers how to load source code files using a special approach with language parsing: each top-level function and class in the code is loaded into separate documents. Any remaining code top-level code outside the already loaded functions and classes will be loaded into a seperate document.",source:"@site/docs/integrations/document_loaders/source_code.md",sourceDirName:"integrations/document_loaders",slug:"/integrations/document_loaders/source_code",permalink:"/langchain/docs/integrations/document_loaders/source_code",draft:!1,tags:[],version:"current",frontMatter:{},sidebar:"integrations",previous:{title:"Snowflake",permalink:"/langchain/docs/integrations/document_loaders/snowflake"},next:{title:"Spreedly",permalink:"/langchain/docs/integrations/document_loaders/spreedly"}},c={},p=[{value:"Splitting",id:"splitting",level:2}],i=(u="CodeOutputBlock",function(e){return console.warn("Component "+u+" was not imported, exported, or provided by MDXProvider as global scope"),(0,o.kt)("div",e)});var u;const d={toc:p},m="wrapper";function g(e){let{components:n,...t}=e;return(0,o.kt)(m,(0,a.Z)({},d,t,{components:n,mdxType:"MDXLayout"}),(0,o.kt)("h1",{id:"source-code"},"Source Code"),(0,o.kt)("p",null,"This notebook covers how to load source code files using a special approach with language parsing: each top-level function and class in the code is loaded into separate documents. Any remaining code top-level code outside the already loaded functions and classes will be loaded into a seperate document."),(0,o.kt)("p",null,"This approach can potentially improve the accuracy of QA models over source code. Currently, the supported languages for code parsing are Python and JavaScript. The language used for parsing can be configured, along with the minimum number of lines required to activate the splitting based on syntax."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"pip install esprima\n")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-python"},'\x3c!--IMPORTS:[{"imported": "Language", "source": "langchain.text_splitter", "docs": "https://api.python.langchain.com/en/latest/text_splitter/langchain.text_splitter.Language.html", "title": "Source Code"}, {"imported": "GenericLoader", "source": "langchain.document_loaders.generic", "docs": "https://api.python.langchain.com/en/latest/document_loaders/langchain.document_loaders.generic.GenericLoader.html", "title": "Source Code"}, {"imported": "LanguageParser", "source": "langchain.document_loaders.parsers", "docs": "https://api.python.langchain.com/en/latest/document_loaders/langchain.document_loaders.parsers.language.language_parser.LanguageParser.html", "title": "Source Code"}]--\x3e\nimport warnings\n\nwarnings.filterwarnings("ignore")\nfrom pprint import pprint\nfrom langchain.text_splitter import Language\nfrom langchain.document_loaders.generic import GenericLoader\nfrom langchain.document_loaders.parsers import LanguageParser\n')),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-python"},'loader = GenericLoader.from_filesystem(\n    "./example_data/source_code",\n    glob="*",\n    suffixes=[".py", ".js"],\n    parser=LanguageParser(),\n)\ndocs = loader.load()\n')),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-python"},"len(docs)\n")),(0,o.kt)(i,{lang:"python",mdxType:"CodeOutputBlock"},(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"    6\n"))),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-python"},"for document in docs:\n    pprint(document.metadata)\n")),(0,o.kt)(i,{lang:"python",mdxType:"CodeOutputBlock"},(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"    {'content_type': 'functions_classes',\n     'language': <Language.PYTHON: 'python'>,\n     'source': 'example_data/source_code/example.py'}\n    {'content_type': 'functions_classes',\n     'language': <Language.PYTHON: 'python'>,\n     'source': 'example_data/source_code/example.py'}\n    {'content_type': 'simplified_code',\n     'language': <Language.PYTHON: 'python'>,\n     'source': 'example_data/source_code/example.py'}\n    {'content_type': 'functions_classes',\n     'language': <Language.JS: 'js'>,\n     'source': 'example_data/source_code/example.js'}\n    {'content_type': 'functions_classes',\n     'language': <Language.JS: 'js'>,\n     'source': 'example_data/source_code/example.js'}\n    {'content_type': 'simplified_code',\n     'language': <Language.JS: 'js'>,\n     'source': 'example_data/source_code/example.js'}\n"))),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-python"},'print("\\n\\n--8<--\\n\\n".join([document.page_content for document in docs]))\n')),(0,o.kt)(i,{lang:"python",mdxType:"CodeOutputBlock"},(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},'    class MyClass:\n        def __init__(self, name):\n            self.name = name\n    \n        def greet(self):\n            print(f"Hello, {self.name}!")\n    \n    --8<--\n    \n    def main():\n        name = input("Enter your name: ")\n        obj = MyClass(name)\n        obj.greet()\n    \n    --8<--\n    \n    # Code for: class MyClass:\n    \n    \n    # Code for: def main():\n    \n    \n    if __name__ == "__main__":\n        main()\n    \n    --8<--\n    \n    class MyClass {\n      constructor(name) {\n        this.name = name;\n      }\n    \n      greet() {\n        console.log(`Hello, ${this.name}!`);\n      }\n    }\n    \n    --8<--\n    \n    function main() {\n      const name = prompt("Enter your name:");\n      const obj = new MyClass(name);\n      obj.greet();\n    }\n    \n    --8<--\n    \n    // Code for: class MyClass {\n    \n    // Code for: function main() {\n    \n    main();\n'))),(0,o.kt)("p",null,"The parser can be disabled for small files. "),(0,o.kt)("p",null,"The parameter ",(0,o.kt)("inlineCode",{parentName:"p"},"parser_threshold")," indicates the minimum number of lines that the source code file must have to be segmented using the parser."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-python"},'loader = GenericLoader.from_filesystem(\n    "./example_data/source_code",\n    glob="*",\n    suffixes=[".py"],\n    parser=LanguageParser(language=Language.PYTHON, parser_threshold=1000),\n)\ndocs = loader.load()\n')),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-python"},"len(docs)\n")),(0,o.kt)(i,{lang:"python",mdxType:"CodeOutputBlock"},(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"    1\n"))),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-python"},"print(docs[0].page_content)\n")),(0,o.kt)(i,{lang:"python",mdxType:"CodeOutputBlock"},(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},'    class MyClass:\n        def __init__(self, name):\n            self.name = name\n    \n        def greet(self):\n            print(f"Hello, {self.name}!")\n    \n    \n    def main():\n        name = input("Enter your name: ")\n        obj = MyClass(name)\n        obj.greet()\n    \n    \n    if __name__ == "__main__":\n        main()\n    \n'))),(0,o.kt)("h2",{id:"splitting"},"Splitting"),(0,o.kt)("p",null,"Additional splitting could be needed for those functions, classes, or scripts that are too big."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-python"},'loader = GenericLoader.from_filesystem(\n    "./example_data/source_code",\n    glob="*",\n    suffixes=[".js"],\n    parser=LanguageParser(language=Language.JS),\n)\ndocs = loader.load()\n')),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-python"},'\x3c!--IMPORTS:[{"imported": "RecursiveCharacterTextSplitter", "source": "langchain.text_splitter", "docs": "https://api.python.langchain.com/en/latest/text_splitter/langchain.text_splitter.RecursiveCharacterTextSplitter.html", "title": "Source Code"}, {"imported": "Language", "source": "langchain.text_splitter", "docs": "https://api.python.langchain.com/en/latest/text_splitter/langchain.text_splitter.Language.html", "title": "Source Code"}]--\x3e\nfrom langchain.text_splitter import (\n    RecursiveCharacterTextSplitter,\n    Language,\n)\n')),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-python"},"js_splitter = RecursiveCharacterTextSplitter.from_language(\n    language=Language.JS, chunk_size=60, chunk_overlap=0\n)\n")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-python"},"result = js_splitter.split_documents(docs)\n")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-python"},"len(result)\n")),(0,o.kt)(i,{lang:"python",mdxType:"CodeOutputBlock"},(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"    7\n"))),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-python"},'print("\\n\\n--8<--\\n\\n".join([document.page_content for document in result]))\n')),(0,o.kt)(i,{lang:"python",mdxType:"CodeOutputBlock"},(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},'    class MyClass {\n      constructor(name) {\n        this.name = name;\n    \n    --8<--\n    \n    }\n    \n    --8<--\n    \n    greet() {\n        console.log(`Hello, ${this.name}!`);\n      }\n    }\n    \n    --8<--\n    \n    function main() {\n      const name = prompt("Enter your name:");\n    \n    --8<--\n    \n    const obj = new MyClass(name);\n      obj.greet();\n    }\n    \n    --8<--\n    \n    // Code for: class MyClass {\n    \n    // Code for: function main() {\n    \n    --8<--\n    \n    main();\n'))))}g.isMDXComponent=!0}}]);