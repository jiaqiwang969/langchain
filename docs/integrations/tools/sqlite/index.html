<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-integrations/tools/sqlite">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.4.0">
<title data-rh="true">SQL Database Chain | 🦜️🔗 Langchain</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://jiaqiwang969.github.io/langchain/img/parrot-chainlink-icon.png"><meta data-rh="true" name="twitter:image" content="https://jiaqiwang969.github.io/langchain/img/parrot-chainlink-icon.png"><meta data-rh="true" property="og:url" content="https://jiaqiwang969.github.io/langchain/docs/integrations/tools/sqlite"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="SQL Database Chain | 🦜️🔗 Langchain"><meta data-rh="true" name="description" content="This example demonstrates the use of the SQLDatabaseChain for answering questions over a SQL database."><meta data-rh="true" property="og:description" content="This example demonstrates the use of the SQLDatabaseChain for answering questions over a SQL database."><link data-rh="true" rel="icon" href="/langchain/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://jiaqiwang969.github.io/langchain/docs/integrations/tools/sqlite"><link data-rh="true" rel="alternate" href="https://jiaqiwang969.github.io/langchain/docs/integrations/tools/sqlite" hreflang="en"><link data-rh="true" rel="alternate" href="https://jiaqiwang969.github.io/langchain/docs/integrations/tools/sqlite" hreflang="x-default"><link rel="stylesheet" href="/langchain/assets/css/styles.b9396054.css">
<link rel="preload" href="/langchain/assets/js/runtime~main.96bce49c.js" as="script">
<link rel="preload" href="/langchain/assets/js/main.581eebae.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function e(e){document.documentElement.setAttribute("data-theme",e)}var t=function(){var e=null;try{e=new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(e){}return e}()||function(){var e=null;try{e=localStorage.getItem("theme")}catch(e){}return e}();null!==t?e(t):window.matchMedia("(prefers-color-scheme: dark)").matches?e("dark"):(window.matchMedia("(prefers-color-scheme: light)").matches,e("light"))}()</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/langchain/"><b class="navbar__title text--truncate">🦜️🔗 LangChain</b></a><a class="navbar__item navbar__link" href="/langchain/docs/get_started/introduction">Docs</a><a class="navbar__item navbar__link" href="/langchain/docs/use_cases">Use cases</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/langchain/docs/integrations">Integrations</a><a href="https://api.python.langchain.com" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">API<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></div><div class="navbar__items navbar__items--right"><a href="https://smith.langchain.com" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">LangSmith</a><a href="https://js.langchain.com/docs" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">JS/TS Docs</a><a href="https://github.com/hwchase17/langchain" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-github-link" aria-label="GitHub repository"></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"><div class="mendable-search"><button class="ms-global search-btn__input ms-m-0 ms-flex ms-h-10 ms-w-full ms-flex-row ms-items-center ms-justify-between ms-gap-2 ms-rounded-xl ms-bg-gray-50 ms-p-1 ms-pl-2 ms-pr-1 ms-shadow ms-outline-none ms-ring-0 ms-transition-all hover:ms-cursor-pointer hover:ms-shadow-md sm:ms-p-2 sm:ms-pl-4 sm:ms-pr-2"><div class="ms-global search-btn__input-container ms-flex ms-w-full ms-min-w-0 ms-items-center ms-gap-1"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 24 24" class="search-btn__icon hover:fill-white ms-h-5 ms-w-5 ms-fill-gray-400 ms-text-gray-400 hover:ms-text-white focus:ms-fill-white focus:ms-text-white sm:ms-h-6 sm:ms-w-6" height="20" width="20" xmlns="http://www.w3.org/2000/svg"><path fill="none" d="M0 0h24v24H0z"></path><path d="M15.5 14h-.79l-.28-.27A6.471 6.471 0 0016 9.5 6.5 6.5 0 109.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"></path></svg><input readonly="" id="userInput" name="userInput" maxlength="512" placeholder="Search..." class="ms-global search-btn__input ms-w-full ms-flex-grow ms-truncate ms-bg-transparent ms-text-sm ms-outline-none ms-ring-0 ms-ring-transparent hover:ms-cursor-text focus:ms-outline-none focus:ms-ring-0 focus:ms-ring-transparent sm:ms-text-base"></div><div class="search-btn__shortcut ms-z-10 ms-flex ms-flex-row ms-items-center ms-gap-1 ms-rounded-lg ms-border ms-py-[2px] ms-px-[8px] ms-text-xs ms-text-gray-400 ms-transition-all disabled:ms-bg-opacity-10"><span>CTRL</span><span>K</span></div></button><div></div></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebarViewport_Xe31"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--active" href="/langchain/docs/integrations">Integrations</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/langchain/docs/integrations/callbacks/">Callbacks</a><button aria-label="Toggle the collapsible sidebar category &#x27;Callbacks&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/langchain/docs/integrations/chat/">Chat models</a><button aria-label="Toggle the collapsible sidebar category &#x27;Chat models&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/langchain/docs/integrations/chat_loaders/">Chat loaders</a><button aria-label="Toggle the collapsible sidebar category &#x27;Chat loaders&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/langchain/docs/integrations/document_loaders/">Document loaders</a><button aria-label="Toggle the collapsible sidebar category &#x27;Document loaders&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/langchain/docs/integrations/document_transformers/">Document transformers</a><button aria-label="Toggle the collapsible sidebar category &#x27;Document transformers&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/langchain/docs/integrations/llms/">LLMs</a><button aria-label="Toggle the collapsible sidebar category &#x27;LLMs&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/langchain/docs/integrations/memory/">Memory</a><button aria-label="Toggle the collapsible sidebar category &#x27;Memory&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/langchain/docs/integrations/retrievers/">Retrievers</a><button aria-label="Toggle the collapsible sidebar category &#x27;Retrievers&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/langchain/docs/integrations/text_embedding/">Text embedding models</a><button aria-label="Toggle the collapsible sidebar category &#x27;Text embedding models&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/langchain/docs/integrations/toolkits/">Agents &amp; Toolkits</a><button aria-label="Toggle the collapsible sidebar category &#x27;Agents &amp; Toolkits&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" tabindex="0" href="/langchain/docs/integrations/tools/">Tools</a><button aria-label="Toggle the collapsible sidebar category &#x27;Tools&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/langchain/docs/integrations/tools/alpha_vantage">Alpha Vantage</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/langchain/docs/integrations/tools/apify">Apify</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/langchain/docs/integrations/tools/arxiv">ArXiv</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/langchain/docs/integrations/tools/awslambda">AWS Lambda</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/langchain/docs/integrations/tools/bash">Shell (bash)</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/langchain/docs/integrations/tools/bing_search">Bing Search</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/langchain/docs/integrations/tools/brave_search">Brave Search</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/langchain/docs/integrations/tools/chatgpt_plugins">ChatGPT Plugins</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/langchain/docs/integrations/tools/dalle_image_generator">Dall-E Image Generator</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/langchain/docs/integrations/tools/dataforseo">DataForSeo</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/langchain/docs/integrations/tools/ddg">DuckDuckGo Search</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/langchain/docs/integrations/tools/edenai_tools">Eden AI</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/langchain/docs/integrations/tools/filesystem">File System</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/langchain/docs/integrations/tools/golden_query">Golden Query</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/langchain/docs/integrations/tools/google_drive">Google Drive</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/langchain/docs/integrations/tools/google_places">Google Places</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/langchain/docs/integrations/tools/google_search">Google Search</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/langchain/docs/integrations/tools/google_serper">Google Serper</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/langchain/docs/integrations/tools/gradio_tools">Gradio</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/langchain/docs/integrations/tools/graphql">GraphQL</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/langchain/docs/integrations/tools/huggingface_tools">HuggingFace Hub Tools</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/langchain/docs/integrations/tools/human_tools">Human as a tool</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/langchain/docs/integrations/tools/ifttt">IFTTT WebHooks</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/langchain/docs/integrations/tools/lemonai">Lemon Agent</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/langchain/docs/integrations/tools/metaphor_search">Metaphor Search</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/langchain/docs/integrations/tools/nuclia">Nuclia Understanding</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/langchain/docs/integrations/tools/openweathermap">OpenWeatherMap</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/langchain/docs/integrations/tools/pubmed">PubMed</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/langchain/docs/integrations/tools/requests">Requests</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/langchain/docs/integrations/tools/sceneXplain">SceneXplain</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/langchain/docs/integrations/tools/search_tools">Search Tools</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/langchain/docs/integrations/tools/searx_search">SearxNG Search</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/langchain/docs/integrations/tools/serpapi">SerpAPI</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/langchain/docs/integrations/tools/sqlite">SQL Database Chain</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/langchain/docs/integrations/tools/twilio">Twilio</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/langchain/docs/integrations/tools/wikipedia">Wikipedia</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/langchain/docs/integrations/tools/wolfram_alpha">Wolfram Alpha</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/langchain/docs/integrations/tools/yahoo_finance_news">Yahoo Finance News</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/langchain/docs/integrations/tools/youtube">YouTube</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/langchain/docs/integrations/tools/zapier">Zapier Natural Language Actions</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/langchain/docs/integrations/vectorstores/">Vector stores</a><button aria-label="Toggle the collapsible sidebar category &#x27;Vector stores&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/langchain/docs/integrations/providers/">Grouped by provider</a><button aria-label="Toggle the collapsible sidebar category &#x27;Grouped by provider&#x27;" type="button" class="clean-btn menu__caret"></button></div></li></ul></li></ul></nav><button type="button" title="Collapse sidebar" aria-label="Collapse sidebar" class="button button--secondary button--outline collapseSidebarButton_PEFL"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_kv0_"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/langchain/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/langchain/docs/integrations"><span itemprop="name">Integrations</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/langchain/docs/integrations/tools/"><span itemprop="name">Tools</span></a><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">SQL Database Chain</span><meta itemprop="position" content="3"></li></ul></nav><div class="theme-doc-markdown markdown"><h1>SQL Database Chain</h1><p>This example demonstrates the use of the <code>SQLDatabaseChain</code> for answering questions over a SQL database.</p><p>Under the hood, LangChain uses SQLAlchemy to connect to SQL databases. The <code>SQLDatabaseChain</code> can therefore be used with any SQL dialect supported by SQLAlchemy, such as MS SQL, MySQL, MariaDB, PostgreSQL, Oracle SQL, <a href="/langchain/docs/ecosystem/integrations/databricks.html">Databricks</a> and SQLite. Please refer to the SQLAlchemy documentation for more information about requirements for connecting to your database. For example, a connection to MySQL requires an appropriate connector such as PyMySQL. A URI for a MySQL connection might look like: <code>mysql+pymysql://user:pass@some_mysql_db_address/db_name</code>.</p><p>This demonstration uses SQLite and the example Chinook database.
To set it up, follow the instructions on <a href="https://database.guide/2-sample-databases-sqlite/" target="_blank" rel="noopener noreferrer">https://database.guide/2-sample-databases-sqlite/</a>, placing the <code>.db</code> file in a notebooks folder at the root of this repository.</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#F5F5F5"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">from</span><span class="token plain"> langchain</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">llms </span><span class="token keyword" style="color:rgb(0, 0, 255)">import</span><span class="token plain"> OpenAI</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">from</span><span class="token plain"> langchain</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">utilities </span><span class="token keyword" style="color:rgb(0, 0, 255)">import</span><span class="token plain"> SQLDatabase</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">from</span><span class="token plain"> langchain_experimental</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">sql </span><span class="token keyword" style="color:rgb(0, 0, 255)">import</span><span class="token plain"> SQLDatabaseChain</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#F5F5F5"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">db </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> SQLDatabase</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">from_uri</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;sqlite:///../../../../notebooks/Chinook.db&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">llm </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> OpenAI</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">temperature</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> verbose</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token boolean">True</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>NOTE:</strong> For data-sensitive projects, you can specify <code>return_direct=True</code> in the <code>SQLDatabaseChain</code> initialization to directly return the output of the SQL query without any additional formatting. This prevents the LLM from seeing any contents within the database. Note, however, the LLM still has access to the database scheme (i.e. dialect, table and key names) by default.</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#F5F5F5"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">db_chain </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> SQLDatabaseChain</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">from_llm</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">llm</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> db</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> verbose</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token boolean">True</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#F5F5F5"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">db_chain</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">run</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;How many employees are there?&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div lang="python"><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#F5F5F5"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">    </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    &gt; Entering new SQLDatabaseChain chain...</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    How many employees are there?</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    SQLQuery:</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    /workspace/langchain/langchain/sql_database.py:191: SAWarning: Dialect sqlite+pysqlite does *not* support Decimal objects natively, and SQLAlchemy must convert from floating point - rounding errors and other issues may occur. Please consider storing Decimal numbers as strings or integers on this platform for lossless storage.</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      sample_rows = connection.execute(command)</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    SELECT COUNT(*) FROM &quot;Employee&quot;;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    SQLResult: [(8,)]</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    Answer:There are 8 employees.</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    &gt; Finished chain.</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    &#x27;There are 8 employees.&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="use-query-checker">Use Query Checker<a href="#use-query-checker" class="hash-link" aria-label="Direct link to Use Query Checker" title="Direct link to Use Query Checker">​</a></h2><p>Sometimes the Language Model generates invalid SQL with small mistakes that can be self-corrected using the same technique used by the SQL Database Agent to try and fix the SQL using the LLM. You can simply specify this option when creating the chain:</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#F5F5F5"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">db_chain </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> SQLDatabaseChain</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">from_llm</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">llm</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> db</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> verbose</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token boolean">True</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> use_query_checker</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token boolean">True</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#F5F5F5"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">db_chain</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">run</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;How many albums by Aerosmith?&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div lang="python"><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#F5F5F5"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">    </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    &gt; Entering new SQLDatabaseChain chain...</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    How many albums by Aerosmith?</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    SQLQuery:SELECT COUNT(*) FROM Album WHERE ArtistId = 3;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    SQLResult: [(1,)]</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    Answer:There is 1 album by Aerosmith.</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    &gt; Finished chain.</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    &#x27;There is 1 album by Aerosmith.&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="customize-prompt">Customize Prompt<a href="#customize-prompt" class="hash-link" aria-label="Direct link to Customize Prompt" title="Direct link to Customize Prompt">​</a></h2><p>You can also customize the prompt that is used. Here is an example prompting it to understand that foobar is the same as the Employee table</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#F5F5F5"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">from</span><span class="token plain"> langchain</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">prompts</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">prompt </span><span class="token keyword" style="color:rgb(0, 0, 255)">import</span><span class="token plain"> PromptTemplate</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">_DEFAULT_TEMPLATE </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token triple-quoted-string string" style="color:rgb(163, 21, 21)">&quot;&quot;&quot;Given an input question, first create a syntactically correct {dialect} query to run, then look at the results of the query and return the answer.</span><br></span><span class="token-line" style="color:#000000"><span class="token triple-quoted-string string" style="color:rgb(163, 21, 21)">Use the following format:</span><br></span><span class="token-line" style="color:#000000"><span class="token triple-quoted-string string" style="display:inline-block;color:rgb(163, 21, 21)"></span><br></span><span class="token-line" style="color:#000000"><span class="token triple-quoted-string string" style="color:rgb(163, 21, 21)">Question: &quot;Question here&quot;</span><br></span><span class="token-line" style="color:#000000"><span class="token triple-quoted-string string" style="color:rgb(163, 21, 21)">SQLQuery: &quot;SQL Query to run&quot;</span><br></span><span class="token-line" style="color:#000000"><span class="token triple-quoted-string string" style="color:rgb(163, 21, 21)">SQLResult: &quot;Result of the SQLQuery&quot;</span><br></span><span class="token-line" style="color:#000000"><span class="token triple-quoted-string string" style="color:rgb(163, 21, 21)">Answer: &quot;Final answer here&quot;</span><br></span><span class="token-line" style="color:#000000"><span class="token triple-quoted-string string" style="display:inline-block;color:rgb(163, 21, 21)"></span><br></span><span class="token-line" style="color:#000000"><span class="token triple-quoted-string string" style="color:rgb(163, 21, 21)">Only use the following tables:</span><br></span><span class="token-line" style="color:#000000"><span class="token triple-quoted-string string" style="display:inline-block;color:rgb(163, 21, 21)"></span><br></span><span class="token-line" style="color:#000000"><span class="token triple-quoted-string string" style="color:rgb(163, 21, 21)">{table_info}</span><br></span><span class="token-line" style="color:#000000"><span class="token triple-quoted-string string" style="display:inline-block;color:rgb(163, 21, 21)"></span><br></span><span class="token-line" style="color:#000000"><span class="token triple-quoted-string string" style="color:rgb(163, 21, 21)">If someone asks for the table foobar, they really mean the employee table.</span><br></span><span class="token-line" style="color:#000000"><span class="token triple-quoted-string string" style="display:inline-block;color:rgb(163, 21, 21)"></span><br></span><span class="token-line" style="color:#000000"><span class="token triple-quoted-string string" style="color:rgb(163, 21, 21)">Question: {input}&quot;&quot;&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">PROMPT </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> PromptTemplate</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    input_variables</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;input&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;table_info&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;dialect&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> template</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain">_DEFAULT_TEMPLATE</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#F5F5F5"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">db_chain </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> SQLDatabaseChain</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">from_llm</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">llm</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> db</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> prompt</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain">PROMPT</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> verbose</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token boolean">True</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#F5F5F5"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">db_chain</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">run</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;How many employees are there in the foobar table?&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div lang="python"><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#F5F5F5"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">    </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    &gt; Entering new SQLDatabaseChain chain...</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    How many employees are there in the foobar table?</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    SQLQuery:SELECT COUNT(*) FROM Employee;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    SQLResult: [(8,)]</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    Answer:There are 8 employees in the foobar table.</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    &gt; Finished chain.</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    &#x27;There are 8 employees in the foobar table.&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="return-intermediate-steps">Return Intermediate Steps<a href="#return-intermediate-steps" class="hash-link" aria-label="Direct link to Return Intermediate Steps" title="Direct link to Return Intermediate Steps">​</a></h2><p>You can also return the intermediate steps of the SQLDatabaseChain. This allows you to access the SQL statement that was generated, as well as the result of running that against the SQL Database.</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#F5F5F5"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">db_chain </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> SQLDatabaseChain</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">from_llm</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">llm</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> db</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> prompt</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain">PROMPT</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> verbose</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token boolean">True</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> use_query_checker</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token boolean">True</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> return_intermediate_steps</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token boolean">True</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#F5F5F5"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">result </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> db_chain</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;How many employees are there in the foobar table?&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">result</span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;intermediate_steps&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div lang="python"><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#F5F5F5"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">    </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    &gt; Entering new SQLDatabaseChain chain...</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    How many employees are there in the foobar table?</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    SQLQuery:SELECT COUNT(*) FROM Employee;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    SQLResult: [(8,)]</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    Answer:There are 8 employees in the foobar table.</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    &gt; Finished chain.</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    [{&#x27;input&#x27;: &#x27;How many employees are there in the foobar table?\nSQLQuery:SELECT COUNT(*) FROM Employee;\nSQLResult: [(8,)]\nAnswer:&#x27;,</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      &#x27;top_k&#x27;: &#x27;5&#x27;,</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      &#x27;dialect&#x27;: &#x27;sqlite&#x27;,</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      &#x27;table_info&#x27;: &#x27;\nCREATE TABLE &quot;Artist&quot; (\n\t&quot;ArtistId&quot; INTEGER NOT NULL, \n\t&quot;Name&quot; NVARCHAR(120), \n\tPRIMARY KEY (&quot;ArtistId&quot;)\n)\n\n/*\n3 rows from Artist table:\nArtistId\tName\n1\tAC/DC\n2\tAccept\n3\tAerosmith\n*/\n\n\nCREATE TABLE &quot;Employee&quot; (\n\t&quot;EmployeeId&quot; INTEGER NOT NULL, \n\t&quot;LastName&quot; NVARCHAR(20) NOT NULL, \n\t&quot;FirstName&quot; NVARCHAR(20) NOT NULL, \n\t&quot;Title&quot; NVARCHAR(30), \n\t&quot;ReportsTo&quot; INTEGER, \n\t&quot;BirthDate&quot; DATETIME, \n\t&quot;HireDate&quot; DATETIME, \n\t&quot;Address&quot; NVARCHAR(70), \n\t&quot;City&quot; NVARCHAR(40), \n\t&quot;State&quot; NVARCHAR(40), \n\t&quot;Country&quot; NVARCHAR(40), \n\t&quot;PostalCode&quot; NVARCHAR(10), \n\t&quot;Phone&quot; NVARCHAR(24), \n\t&quot;Fax&quot; NVARCHAR(24), \n\t&quot;Email&quot; NVARCHAR(60), \n\tPRIMARY KEY (&quot;EmployeeId&quot;), \n\tFOREIGN KEY(&quot;ReportsTo&quot;) REFERENCES &quot;Employee&quot; (&quot;EmployeeId&quot;)\n)\n\n/*\n3 rows from Employee table:\nEmployeeId\tLastName\tFirstName\tTitle\tReportsTo\tBirthDate\tHireDate\tAddress\tCity\tState\tCountry\tPostalCode\tPhone\tFax\tEmail\n1\tAdams\tAndrew\tGeneral Manager\tNone\t1962-02-18 00:00:00\t2002-08-14 00:00:00\t11120 Jasper Ave NW\tEdmonton\tAB\tCanada\tT5K 2N1\t+1 (780) 428-9482\t+1 (780) 428-3457\tandrew@chinookcorp.com\n2\tEdwards\tNancy\tSales Manager\t1\t1958-12-08 00:00:00\t2002-05-01 00:00:00\t825 8 Ave SW\tCalgary\tAB\tCanada\tT2P 2T3\t+1 (403) 262-3443\t+1 (403) 262-3322\tnancy@chinookcorp.com\n3\tPeacock\tJane\tSales Support Agent\t2\t1973-08-29 00:00:00\t2002-04-01 00:00:00\t1111 6 Ave SW\tCalgary\tAB\tCanada\tT2P 5M5\t+1 (403) 262-3443\t+1 (403) 262-6712\tjane@chinookcorp.com\n*/\n\n\nCREATE TABLE &quot;Genre&quot; (\n\t&quot;GenreId&quot; INTEGER NOT NULL, \n\t&quot;Name&quot; NVARCHAR(120), \n\tPRIMARY KEY (&quot;GenreId&quot;)\n)\n\n/*\n3 rows from Genre table:\nGenreId\tName\n1\tRock\n2\tJazz\n3\tMetal\n*/\n\n\nCREATE TABLE &quot;MediaType&quot; (\n\t&quot;MediaTypeId&quot; INTEGER NOT NULL, \n\t&quot;Name&quot; NVARCHAR(120), \n\tPRIMARY KEY (&quot;MediaTypeId&quot;)\n)\n\n/*\n3 rows from MediaType table:\nMediaTypeId\tName\n1\tMPEG audio file\n2\tProtected AAC audio file\n3\tProtected MPEG-4 video file\n*/\n\n\nCREATE TABLE &quot;Playlist&quot; (\n\t&quot;PlaylistId&quot; INTEGER NOT NULL, \n\t&quot;Name&quot; NVARCHAR(120), \n\tPRIMARY KEY (&quot;PlaylistId&quot;)\n)\n\n/*\n3 rows from Playlist table:\nPlaylistId\tName\n1\tMusic\n2\tMovies\n3\tTV Shows\n*/\n\n\nCREATE TABLE &quot;Album&quot; (\n\t&quot;AlbumId&quot; INTEGER NOT NULL, \n\t&quot;Title&quot; NVARCHAR(160) NOT NULL, \n\t&quot;ArtistId&quot; INTEGER NOT NULL, \n\tPRIMARY KEY (&quot;AlbumId&quot;), \n\tFOREIGN KEY(&quot;ArtistId&quot;) REFERENCES &quot;Artist&quot; (&quot;ArtistId&quot;)\n)\n\n/*\n3 rows from Album table:\nAlbumId\tTitle\tArtistId\n1\tFor Those About To Rock We Salute You\t1\n2\tBalls to the Wall\t2\n3\tRestless and Wild\t2\n*/\n\n\nCREATE TABLE &quot;Customer&quot; (\n\t&quot;CustomerId&quot; INTEGER NOT NULL, \n\t&quot;FirstName&quot; NVARCHAR(40) NOT NULL, \n\t&quot;LastName&quot; NVARCHAR(20) NOT NULL, \n\t&quot;Company&quot; NVARCHAR(80), \n\t&quot;Address&quot; NVARCHAR(70), \n\t&quot;City&quot; NVARCHAR(40), \n\t&quot;State&quot; NVARCHAR(40), \n\t&quot;Country&quot; NVARCHAR(40), \n\t&quot;PostalCode&quot; NVARCHAR(10), \n\t&quot;Phone&quot; NVARCHAR(24), \n\t&quot;Fax&quot; NVARCHAR(24), \n\t&quot;Email&quot; NVARCHAR(60) NOT NULL, \n\t&quot;SupportRepId&quot; INTEGER, \n\tPRIMARY KEY (&quot;CustomerId&quot;), \n\tFOREIGN KEY(&quot;SupportRepId&quot;) REFERENCES &quot;Employee&quot; (&quot;EmployeeId&quot;)\n)\n\n/*\n3 rows from Customer table:\nCustomerId\tFirstName\tLastName\tCompany\tAddress\tCity\tState\tCountry\tPostalCode\tPhone\tFax\tEmail\tSupportRepId\n1\tLuís\tGonçalves\tEmbraer - Empresa Brasileira de Aeronáutica S.A.\tAv. Brigadeiro Faria Lima, 2170\tSão José dos Campos\tSP\tBrazil\t12227-000\t+55 (12) 3923-5555\t+55 (12) 3923-5566\tluisg@embraer.com.br\t3\n2\tLeonie\tKöhler\tNone\tTheodor-Heuss-Straße 34\tStuttgart\tNone\tGermany\t70174\t+49 0711 2842222\tNone\tleonekohler@surfeu.de\t5\n3\tFrançois\tTremblay\tNone\t1498 rue Bélanger\tMontréal\tQC\tCanada\tH2G 1A7\t+1 (514) 721-4711\tNone\tftremblay@gmail.com\t3\n*/\n\n\nCREATE TABLE &quot;Invoice&quot; (\n\t&quot;InvoiceId&quot; INTEGER NOT NULL, \n\t&quot;CustomerId&quot; INTEGER NOT NULL, \n\t&quot;InvoiceDate&quot; DATETIME NOT NULL, \n\t&quot;BillingAddress&quot; NVARCHAR(70), \n\t&quot;BillingCity&quot; NVARCHAR(40), \n\t&quot;BillingState&quot; NVARCHAR(40), \n\t&quot;BillingCountry&quot; NVARCHAR(40), \n\t&quot;BillingPostalCode&quot; NVARCHAR(10), \n\t&quot;Total&quot; NUMERIC(10, 2) NOT NULL, \n\tPRIMARY KEY (&quot;InvoiceId&quot;), \n\tFOREIGN KEY(&quot;CustomerId&quot;) REFERENCES &quot;Customer&quot; (&quot;CustomerId&quot;)\n)\n\n/*\n3 rows from Invoice table:\nInvoiceId\tCustomerId\tInvoiceDate\tBillingAddress\tBillingCity\tBillingState\tBillingCountry\tBillingPostalCode\tTotal\n1\t2\t2009-01-01 00:00:00\tTheodor-Heuss-Straße 34\tStuttgart\tNone\tGermany\t70174\t1.98\n2\t4\t2009-01-02 00:00:00\tUllevålsveien 14\tOslo\tNone\tNorway\t0171\t3.96\n3\t8\t2009-01-03 00:00:00\tGrétrystraat 63\tBrussels\tNone\tBelgium\t1000\t5.94\n*/\n\n\nCREATE TABLE &quot;Track&quot; (\n\t&quot;TrackId&quot; INTEGER NOT NULL, \n\t&quot;Name&quot; NVARCHAR(200) NOT NULL, \n\t&quot;AlbumId&quot; INTEGER, \n\t&quot;MediaTypeId&quot; INTEGER NOT NULL, \n\t&quot;GenreId&quot; INTEGER, \n\t&quot;Composer&quot; NVARCHAR(220), \n\t&quot;Milliseconds&quot; INTEGER NOT NULL, \n\t&quot;Bytes&quot; INTEGER, \n\t&quot;UnitPrice&quot; NUMERIC(10, 2) NOT NULL, \n\tPRIMARY KEY (&quot;TrackId&quot;), \n\tFOREIGN KEY(&quot;MediaTypeId&quot;) REFERENCES &quot;MediaType&quot; (&quot;MediaTypeId&quot;), \n\tFOREIGN KEY(&quot;GenreId&quot;) REFERENCES &quot;Genre&quot; (&quot;GenreId&quot;), \n\tFOREIGN KEY(&quot;AlbumId&quot;) REFERENCES &quot;Album&quot; (&quot;AlbumId&quot;)\n)\n\n/*\n3 rows from Track table:\nTrackId\tName\tAlbumId\tMediaTypeId\tGenreId\tComposer\tMilliseconds\tBytes\tUnitPrice\n1\tFor Those About To Rock (We Salute You)\t1\t1\t1\tAngus Young, Malcolm Young, Brian Johnson\t343719\t11170334\t0.99\n2\tBalls to the Wall\t2\t2\t1\tNone\t342562\t5510424\t0.99\n3\tFast As a Shark\t3\t2\t1\tF. Baltes, S. Kaufman, U. Dirkscneider &amp; W. Hoffman\t230619\t3990994\t0.99\n*/\n\n\nCREATE TABLE &quot;InvoiceLine&quot; (\n\t&quot;InvoiceLineId&quot; INTEGER NOT NULL, \n\t&quot;InvoiceId&quot; INTEGER NOT NULL, \n\t&quot;TrackId&quot; INTEGER NOT NULL, \n\t&quot;UnitPrice&quot; NUMERIC(10, 2) NOT NULL, \n\t&quot;Quantity&quot; INTEGER NOT NULL, \n\tPRIMARY KEY (&quot;InvoiceLineId&quot;), \n\tFOREIGN KEY(&quot;TrackId&quot;) REFERENCES &quot;Track&quot; (&quot;TrackId&quot;), \n\tFOREIGN KEY(&quot;InvoiceId&quot;) REFERENCES &quot;Invoice&quot; (&quot;InvoiceId&quot;)\n)\n\n/*\n3 rows from InvoiceLine table:\nInvoiceLineId\tInvoiceId\tTrackId\tUnitPrice\tQuantity\n1\t1\t2\t0.99\t1\n2\t1\t4\t0.99\t1\n3\t2\t6\t0.99\t1\n*/\n\n\nCREATE TABLE &quot;PlaylistTrack&quot; (\n\t&quot;PlaylistId&quot; INTEGER NOT NULL, \n\t&quot;TrackId&quot; INTEGER NOT NULL, \n\tPRIMARY KEY (&quot;PlaylistId&quot;, &quot;TrackId&quot;), \n\tFOREIGN KEY(&quot;TrackId&quot;) REFERENCES &quot;Track&quot; (&quot;TrackId&quot;), \n\tFOREIGN KEY(&quot;PlaylistId&quot;) REFERENCES &quot;Playlist&quot; (&quot;PlaylistId&quot;)\n)\n\n/*\n3 rows from PlaylistTrack table:\nPlaylistId\tTrackId\n1\t3402\n1\t3389\n1\t3390\n*/&#x27;,</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      &#x27;stop&#x27;: [&#x27;\nSQLResult:&#x27;]},</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">     &#x27;SELECT COUNT(*) FROM Employee;&#x27;,</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">     {&#x27;query&#x27;: &#x27;SELECT COUNT(*) FROM Employee;&#x27;, &#x27;dialect&#x27;: &#x27;sqlite&#x27;},</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">     &#x27;SELECT COUNT(*) FROM Employee;&#x27;,</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">     &#x27;[(8,)]&#x27;]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="choosing-how-to-limit-the-number-of-rows-returned">Choosing how to limit the number of rows returned<a href="#choosing-how-to-limit-the-number-of-rows-returned" class="hash-link" aria-label="Direct link to Choosing how to limit the number of rows returned" title="Direct link to Choosing how to limit the number of rows returned">​</a></h2><p>If you are querying for several rows of a table you can select the maximum number of results you want to get by using the &#x27;top_k&#x27; parameter (default is 10). This is useful for avoiding query results that exceed the prompt max length or consume tokens unnecessarily.</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#F5F5F5"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">db_chain </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> SQLDatabaseChain</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">from_llm</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">llm</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> db</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> verbose</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token boolean">True</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> use_query_checker</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token boolean">True</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> top_k</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token number" style="color:rgb(9, 134, 88)">3</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#F5F5F5"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">db_chain</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">run</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;What are some example tracks by composer Johann Sebastian Bach?&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div lang="python"><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#F5F5F5"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">    </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    &gt; Entering new SQLDatabaseChain chain...</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    What are some example tracks by composer Johann Sebastian Bach?</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    SQLQuery:SELECT Name FROM Track WHERE Composer = &#x27;Johann Sebastian Bach&#x27; LIMIT 3</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    SQLResult: [(&#x27;Concerto for 2 Violins in D Minor, BWV 1043: I. Vivace&#x27;,), (&#x27;Aria Mit 30 Veränderungen, BWV 988 &quot;Goldberg Variations&quot;: Aria&#x27;,), (&#x27;Suite for Solo Cello No. 1 in G Major, BWV 1007: I. Prélude&#x27;,)]</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    Answer:Examples of tracks by Johann Sebastian Bach are Concerto for 2 Violins in D Minor, BWV 1043: I. Vivace, Aria Mit 30 Veränderungen, BWV 988 &quot;Goldberg Variations&quot;: Aria, and Suite for Solo Cello No. 1 in G Major, BWV 1007: I. Prélude.</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    &gt; Finished chain.</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    &#x27;Examples of tracks by Johann Sebastian Bach are Concerto for 2 Violins in D Minor, BWV 1043: I. Vivace, Aria Mit 30 Veränderungen, BWV 988 &quot;Goldberg Variations&quot;: Aria, and Suite for Solo Cello No. 1 in G Major, BWV 1007: I. Prélude.&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="adding-example-rows-from-each-table">Adding example rows from each table<a href="#adding-example-rows-from-each-table" class="hash-link" aria-label="Direct link to Adding example rows from each table" title="Direct link to Adding example rows from each table">​</a></h2><p>Sometimes, the format of the data is not obvious and it is optimal to include a sample of rows from the tables in the prompt to allow the LLM to understand the data before providing a final query. Here we will use this feature to let the LLM know that artists are saved with their full names by providing two rows from the <code>Track</code> table.</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#F5F5F5"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">db </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> SQLDatabase</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">from_uri</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;sqlite:///../../../../notebooks/Chinook.db&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    include_tables</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;Track&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token comment" style="color:rgb(0, 128, 0)"># we include only one table to save tokens in the prompt :)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    sample_rows_in_table_info</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token number" style="color:rgb(9, 134, 88)">2</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The sample rows are added to the prompt after each corresponding table&#x27;s column information:</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#F5F5F5"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">print</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">db</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">table_info</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div lang="python"><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#F5F5F5"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">    </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    CREATE TABLE &quot;Track&quot; (</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        &quot;TrackId&quot; INTEGER NOT NULL, </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        &quot;Name&quot; NVARCHAR(200) NOT NULL, </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        &quot;AlbumId&quot; INTEGER, </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        &quot;MediaTypeId&quot; INTEGER NOT NULL, </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        &quot;GenreId&quot; INTEGER, </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        &quot;Composer&quot; NVARCHAR(220), </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        &quot;Milliseconds&quot; INTEGER NOT NULL, </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        &quot;Bytes&quot; INTEGER, </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        &quot;UnitPrice&quot; NUMERIC(10, 2) NOT NULL, </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        PRIMARY KEY (&quot;TrackId&quot;), </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        FOREIGN KEY(&quot;MediaTypeId&quot;) REFERENCES &quot;MediaType&quot; (&quot;MediaTypeId&quot;), </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        FOREIGN KEY(&quot;GenreId&quot;) REFERENCES &quot;Genre&quot; (&quot;GenreId&quot;), </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        FOREIGN KEY(&quot;AlbumId&quot;) REFERENCES &quot;Album&quot; (&quot;AlbumId&quot;)</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    )</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    /*</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    2 rows from Track table:</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    TrackId Name    AlbumId MediaTypeId GenreId Composer    Milliseconds    Bytes   UnitPrice</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    1   For Those About To Rock (We Salute You) 1   1   1   Angus Young, Malcolm Young, Brian Johnson   343719  11170334    0.99</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    2   Balls to the Wall   2   2   1   None    342562  5510424 0.99</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    */</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#F5F5F5"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">db_chain </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> SQLDatabaseChain</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">from_llm</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">llm</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> db</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> use_query_checker</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token boolean">True</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> verbose</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token boolean">True</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#F5F5F5"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">db_chain</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">run</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;What are some example tracks by Bach?&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div lang="python"><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#F5F5F5"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">    </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    &gt; Entering new SQLDatabaseChain chain...</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    What are some example tracks by Bach?</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    SQLQuery:SELECT &quot;Name&quot;, &quot;Composer&quot; FROM &quot;Track&quot; WHERE &quot;Composer&quot; LIKE &#x27;%Bach%&#x27; LIMIT 5</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    SQLResult: [(&#x27;American Woman&#x27;, &#x27;B. Cummings/G. Peterson/M.J. Kale/R. Bachman&#x27;), (&#x27;Concerto for 2 Violins in D Minor, BWV 1043: I. Vivace&#x27;, &#x27;Johann Sebastian Bach&#x27;), (&#x27;Aria Mit 30 Veränderungen, BWV 988 &quot;Goldberg Variations&quot;: Aria&#x27;, &#x27;Johann Sebastian Bach&#x27;), (&#x27;Suite for Solo Cello No. 1 in G Major, BWV 1007: I. Prélude&#x27;, &#x27;Johann Sebastian Bach&#x27;), (&#x27;Toccata and Fugue in D Minor, BWV 565: I. Toccata&#x27;, &#x27;Johann Sebastian Bach&#x27;)]</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    Answer:Tracks by Bach include &#x27;American Woman&#x27;, &#x27;Concerto for 2 Violins in D Minor, BWV 1043: I. Vivace&#x27;, &#x27;Aria Mit 30 Veränderungen, BWV 988 &quot;Goldberg Variations&quot;: Aria&#x27;, &#x27;Suite for Solo Cello No. 1 in G Major, BWV 1007: I. Prélude&#x27;, and &#x27;Toccata and Fugue in D Minor, BWV 565: I. Toccata&#x27;.</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    &gt; Finished chain.</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    &#x27;Tracks by Bach include \&#x27;American Woman\&#x27;, \&#x27;Concerto for 2 Violins in D Minor, BWV 1043: I. Vivace\&#x27;, \&#x27;Aria Mit 30 Veränderungen, BWV 988 &quot;Goldberg Variations&quot;: Aria\&#x27;, \&#x27;Suite for Solo Cello No. 1 in G Major, BWV 1007: I. Prélude\&#x27;, and \&#x27;Toccata and Fugue in D Minor, BWV 565: I. Toccata\&#x27;.&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="custom-table-info">Custom Table Info<a href="#custom-table-info" class="hash-link" aria-label="Direct link to Custom Table Info" title="Direct link to Custom Table Info">​</a></h3><p>In some cases, it can be useful to provide custom table information instead of using the automatically generated table definitions and the first <code>sample_rows_in_table_info</code> sample rows. For example, if you know that the first few rows of a table are uninformative, it could help to manually provide example rows that are more diverse or provide more information to the model. It is also possible to limit the columns that will be visible to the model if there are unnecessary columns. </p><p>This information can be provided as a dictionary with table names as the keys and table information as the values. For example, let&#x27;s provide a custom definition and sample rows for the Track table with only a few columns:</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#F5F5F5"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">custom_table_info </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;Track&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token triple-quoted-string string" style="color:rgb(163, 21, 21)">&quot;&quot;&quot;CREATE TABLE Track (</span><br></span><span class="token-line" style="color:#000000"><span class="token triple-quoted-string string" style="color:rgb(163, 21, 21)">    &quot;TrackId&quot; INTEGER NOT NULL, </span><br></span><span class="token-line" style="color:#000000"><span class="token triple-quoted-string string" style="color:rgb(163, 21, 21)">    &quot;Name&quot; NVARCHAR(200) NOT NULL,</span><br></span><span class="token-line" style="color:#000000"><span class="token triple-quoted-string string" style="color:rgb(163, 21, 21)">    &quot;Composer&quot; NVARCHAR(220),</span><br></span><span class="token-line" style="color:#000000"><span class="token triple-quoted-string string" style="color:rgb(163, 21, 21)">    PRIMARY KEY (&quot;TrackId&quot;)</span><br></span><span class="token-line" style="color:#000000"><span class="token triple-quoted-string string" style="color:rgb(163, 21, 21)">)</span><br></span><span class="token-line" style="color:#000000"><span class="token triple-quoted-string string" style="color:rgb(163, 21, 21)">/*</span><br></span><span class="token-line" style="color:#000000"><span class="token triple-quoted-string string" style="color:rgb(163, 21, 21)">3 rows from Track table:</span><br></span><span class="token-line" style="color:#000000"><span class="token triple-quoted-string string" style="color:rgb(163, 21, 21)">TrackId Name    Composer</span><br></span><span class="token-line" style="color:#000000"><span class="token triple-quoted-string string" style="color:rgb(163, 21, 21)">1   For Those About To Rock (We Salute You) Angus Young, Malcolm Young, Brian Johnson</span><br></span><span class="token-line" style="color:#000000"><span class="token triple-quoted-string string" style="color:rgb(163, 21, 21)">2   Balls to the Wall   None</span><br></span><span class="token-line" style="color:#000000"><span class="token triple-quoted-string string" style="color:rgb(163, 21, 21)">3   My favorite song ever   The coolest composer of all time</span><br></span><span class="token-line" style="color:#000000"><span class="token triple-quoted-string string" style="color:rgb(163, 21, 21)">*/&quot;&quot;&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#F5F5F5"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">db </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> SQLDatabase</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">from_uri</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;sqlite:///../../../../notebooks/Chinook.db&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    include_tables</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;Track&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;Playlist&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    sample_rows_in_table_info</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token number" style="color:rgb(9, 134, 88)">2</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    custom_table_info</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain">custom_table_info</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">print</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">db</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">table_info</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div lang="python"><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#F5F5F5"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">    </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    CREATE TABLE &quot;Playlist&quot; (</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        &quot;PlaylistId&quot; INTEGER NOT NULL, </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        &quot;Name&quot; NVARCHAR(120), </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        PRIMARY KEY (&quot;PlaylistId&quot;)</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    )</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    /*</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    2 rows from Playlist table:</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    PlaylistId  Name</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    1   Music</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    2   Movies</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    */</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    CREATE TABLE Track (</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        &quot;TrackId&quot; INTEGER NOT NULL, </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        &quot;Name&quot; NVARCHAR(200) NOT NULL,</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        &quot;Composer&quot; NVARCHAR(220),</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        PRIMARY KEY (&quot;TrackId&quot;)</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    )</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    /*</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    3 rows from Track table:</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    TrackId Name    Composer</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    1   For Those About To Rock (We Salute You) Angus Young, Malcolm Young, Brian Johnson</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    2   Balls to the Wall   None</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    3   My favorite song ever   The coolest composer of all time</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    */</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div><p>Note how our custom table definition and sample rows for <code>Track</code> overrides the <code>sample_rows_in_table_info</code> parameter. Tables that are not overridden by <code>custom_table_info</code>, in this example <code>Playlist</code>, will have their table info gathered automatically as usual.</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#F5F5F5"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">db_chain </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> SQLDatabaseChain</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">from_llm</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">llm</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> db</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> verbose</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token boolean">True</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">db_chain</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">run</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;What are some example tracks by Bach?&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div lang="python"><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#F5F5F5"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">    </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    &gt; Entering new SQLDatabaseChain chain...</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    What are some example tracks by Bach?</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    SQLQuery:SELECT &quot;Name&quot; FROM Track WHERE &quot;Composer&quot; LIKE &#x27;%Bach%&#x27; LIMIT 5;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    SQLResult: [(&#x27;American Woman&#x27;,), (&#x27;Concerto for 2 Violins in D Minor, BWV 1043: I. Vivace&#x27;,), (&#x27;Aria Mit 30 Veränderungen, BWV 988 &quot;Goldberg Variations&quot;: Aria&#x27;,), (&#x27;Suite for Solo Cello No. 1 in G Major, BWV 1007: I. Prélude&#x27;,), (&#x27;Toccata and Fugue in D Minor, BWV 565: I. Toccata&#x27;,)]</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    Answer:text=&#x27;You are a SQLite expert. Given an input question, first create a syntactically correct SQLite query to run, then look at the results of the query and return the answer to the input question.\nUnless the user specifies in the question a specific number of examples to obtain, query for at most 5 results using the LIMIT clause as per SQLite. You can order the results to return the most informative data in the database.\nNever query for all columns from a table. You must query only the columns that are needed to answer the question. Wrap each column name in double quotes (&quot;) to denote them as delimited identifiers.\nPay attention to use only the column names you can see in the tables below. Be careful to not query for columns that do not exist. Also, pay attention to which column is in which table.\n\nUse the following format:\n\nQuestion: &quot;Question here&quot;\nSQLQuery: &quot;SQL Query to run&quot;\nSQLResult: &quot;Result of the SQLQuery&quot;\nAnswer: &quot;Final answer here&quot;\n\nOnly use the following tables:\n\nCREATE TABLE &quot;Playlist&quot; (\n\t&quot;PlaylistId&quot; INTEGER NOT NULL, \n\t&quot;Name&quot; NVARCHAR(120), \n\tPRIMARY KEY (&quot;PlaylistId&quot;)\n)\n\n/*\n2 rows from Playlist table:\nPlaylistId\tName\n1\tMusic\n2\tMovies\n*/\n\nCREATE TABLE Track (\n\t&quot;TrackId&quot; INTEGER NOT NULL, \n\t&quot;Name&quot; NVARCHAR(200) NOT NULL,\n\t&quot;Composer&quot; NVARCHAR(220),\n\tPRIMARY KEY (&quot;TrackId&quot;)\n)\n/*\n3 rows from Track table:\nTrackId\tName\tComposer\n1\tFor Those About To Rock (We Salute You)\tAngus Young, Malcolm Young, Brian Johnson\n2\tBalls to the Wall\tNone\n3\tMy favorite song ever\tThe coolest composer of all time\n*/\n\nQuestion: What are some example tracks by Bach?\nSQLQuery:SELECT &quot;Name&quot; FROM Track WHERE &quot;Composer&quot; LIKE \&#x27;%Bach%\&#x27; LIMIT 5;\nSQLResult: [(\&#x27;American Woman\&#x27;,), (\&#x27;Concerto for 2 Violins in D Minor, BWV 1043: I. Vivace\&#x27;,), (\&#x27;Aria Mit 30 Veränderungen, BWV 988 &quot;Goldberg Variations&quot;: Aria\&#x27;,), (\&#x27;Suite for Solo Cello No. 1 in G Major, BWV 1007: I. Prélude\&#x27;,), (\&#x27;Toccata and Fugue in D Minor, BWV 565: I. Toccata\&#x27;,)]\nAnswer:&#x27;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    You are a SQLite expert. Given an input question, first create a syntactically correct SQLite query to run, then look at the results of the query and return the answer to the input question.</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    Unless the user specifies in the question a specific number of examples to obtain, query for at most 5 results using the LIMIT clause as per SQLite. You can order the results to return the most informative data in the database.</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    Never query for all columns from a table. You must query only the columns that are needed to answer the question. Wrap each column name in double quotes (&quot;) to denote them as delimited identifiers.</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    Pay attention to use only the column names you can see in the tables below. Be careful to not query for columns that do not exist. Also, pay attention to which column is in which table.</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    Use the following format:</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    Question: &quot;Question here&quot;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    SQLQuery: &quot;SQL Query to run&quot;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    SQLResult: &quot;Result of the SQLQuery&quot;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    Answer: &quot;Final answer here&quot;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    Only use the following tables:</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    CREATE TABLE &quot;Playlist&quot; (</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        &quot;PlaylistId&quot; INTEGER NOT NULL, </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        &quot;Name&quot; NVARCHAR(120), </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        PRIMARY KEY (&quot;PlaylistId&quot;)</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    )</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    /*</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    2 rows from Playlist table:</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    PlaylistId  Name</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    1   Music</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    2   Movies</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    */</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    CREATE TABLE Track (</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        &quot;TrackId&quot; INTEGER NOT NULL, </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        &quot;Name&quot; NVARCHAR(200) NOT NULL,</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        &quot;Composer&quot; NVARCHAR(220),</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        PRIMARY KEY (&quot;TrackId&quot;)</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    )</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    /*</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    3 rows from Track table:</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    TrackId Name    Composer</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    1   For Those About To Rock (We Salute You) Angus Young, Malcolm Young, Brian Johnson</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    2   Balls to the Wall   None</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    3   My favorite song ever   The coolest composer of all time</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    */</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    Question: What are some example tracks by Bach?</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    SQLQuery:SELECT &quot;Name&quot; FROM Track WHERE &quot;Composer&quot; LIKE &#x27;%Bach%&#x27; LIMIT 5;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    SQLResult: [(&#x27;American Woman&#x27;,), (&#x27;Concerto for 2 Violins in D Minor, BWV 1043: I. Vivace&#x27;,), (&#x27;Aria Mit 30 Veränderungen, BWV 988 &quot;Goldberg Variations&quot;: Aria&#x27;,), (&#x27;Suite for Solo Cello No. 1 in G Major, BWV 1007: I. Prélude&#x27;,), (&#x27;Toccata and Fugue in D Minor, BWV 565: I. Toccata&#x27;,)]</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    Answer:</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    {&#x27;input&#x27;: &#x27;What are some example tracks by Bach?\nSQLQuery:SELECT &quot;Name&quot; FROM Track WHERE &quot;Composer&quot; LIKE \&#x27;%Bach%\&#x27; LIMIT 5;\nSQLResult: [(\&#x27;American Woman\&#x27;,), (\&#x27;Concerto for 2 Violins in D Minor, BWV 1043: I. Vivace\&#x27;,), (\&#x27;Aria Mit 30 Veränderungen, BWV 988 &quot;Goldberg Variations&quot;: Aria\&#x27;,), (\&#x27;Suite for Solo Cello No. 1 in G Major, BWV 1007: I. Prélude\&#x27;,), (\&#x27;Toccata and Fugue in D Minor, BWV 565: I. Toccata\&#x27;,)]\nAnswer:&#x27;, &#x27;top_k&#x27;: &#x27;5&#x27;, &#x27;dialect&#x27;: &#x27;sqlite&#x27;, &#x27;table_info&#x27;: &#x27;\nCREATE TABLE &quot;Playlist&quot; (\n\t&quot;PlaylistId&quot; INTEGER NOT NULL, \n\t&quot;Name&quot; NVARCHAR(120), \n\tPRIMARY KEY (&quot;PlaylistId&quot;)\n)\n\n/*\n2 rows from Playlist table:\nPlaylistId\tName\n1\tMusic\n2\tMovies\n*/\n\nCREATE TABLE Track (\n\t&quot;TrackId&quot; INTEGER NOT NULL, \n\t&quot;Name&quot; NVARCHAR(200) NOT NULL,\n\t&quot;Composer&quot; NVARCHAR(220),\n\tPRIMARY KEY (&quot;TrackId&quot;)\n)\n/*\n3 rows from Track table:\nTrackId\tName\tComposer\n1\tFor Those About To Rock (We Salute You)\tAngus Young, Malcolm Young, Brian Johnson\n2\tBalls to the Wall\tNone\n3\tMy favorite song ever\tThe coolest composer of all time\n*/&#x27;, &#x27;stop&#x27;: [&#x27;\nSQLResult:&#x27;]}</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    Examples of tracks by Bach include &quot;American Woman&quot;, &quot;Concerto for 2 Violins in D Minor, BWV 1043: I. Vivace&quot;, &quot;Aria Mit 30 Veränderungen, BWV 988 &#x27;Goldberg Variations&#x27;: Aria&quot;, &quot;Suite for Solo Cello No. 1 in G Major, BWV 1007: I. Prélude&quot;, and &quot;Toccata and Fugue in D Minor, BWV 565: I. Toccata&quot;.</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    &gt; Finished chain.</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    &#x27;Examples of tracks by Bach include &quot;American Woman&quot;, &quot;Concerto for 2 Violins in D Minor, BWV 1043: I. Vivace&quot;, &quot;Aria Mit 30 Veränderungen, BWV 988 \&#x27;Goldberg Variations\&#x27;: Aria&quot;, &quot;Suite for Solo Cello No. 1 in G Major, BWV 1007: I. Prélude&quot;, and &quot;Toccata and Fugue in D Minor, BWV 565: I. Toccata&quot;.&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="sql-views">SQL Views<a href="#sql-views" class="hash-link" aria-label="Direct link to SQL Views" title="Direct link to SQL Views">​</a></h3><p>In some case, the table schema can be hidden behind a JSON or JSONB column. Adding row samples into the prompt might help won&#x27;t always describe the data perfectly. </p><p>For this reason, a custom SQL views can help.</p><div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#F5F5F5"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">CREATE</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">VIEW</span><span class="token plain"> accounts_v </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">select</span><span class="token plain"> id</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> firstname</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> lastname</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> email</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> created_at</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> updated_at</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        cast</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">stats</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;&gt;</span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;total_post&#x27;</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">as</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">int</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">as</span><span class="token plain"> total_post</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        cast</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">stats</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;&gt;</span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;total_comments&#x27;</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">as</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">int</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">as</span><span class="token plain"> total_comments</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        cast</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">stats</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;&gt;</span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;ltv&#x27;</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">as</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">int</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">as</span><span class="token plain"> ltv</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">FROM</span><span class="token plain"> accounts</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Then limit the tables visible from SQLDatabase to the created view.</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#F5F5F5"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">db </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> SQLDatabase</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">from_uri</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;sqlite:///../../../../notebooks/Chinook.db&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    include_tables</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;accounts_v&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token comment" style="color:rgb(0, 128, 0)"># we include only the view</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="sqldatabasesequentialchain">SQLDatabaseSequentialChain<a href="#sqldatabasesequentialchain" class="hash-link" aria-label="Direct link to SQLDatabaseSequentialChain" title="Direct link to SQLDatabaseSequentialChain">​</a></h2><p>Chain for querying SQL database that is a sequential chain.</p><p>The chain is as follows:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#F5F5F5"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">1. Based on the query, determine which tables to use.</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">2. Based on those tables, call the normal SQL database chain.</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>This is useful in cases where the number of tables in the database is large.</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#F5F5F5"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">from</span><span class="token plain"> langchain_experimental</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">sql </span><span class="token keyword" style="color:rgb(0, 0, 255)">import</span><span class="token plain"> SQLDatabaseSequentialChain</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">db </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> SQLDatabase</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">from_uri</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;sqlite:///../../../../notebooks/Chinook.db&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#F5F5F5"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">chain </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> SQLDatabaseSequentialChain</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">from_llm</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">llm</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> db</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> verbose</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token boolean">True</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#F5F5F5"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">chain</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">run</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;How many employees are also customers?&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div lang="python"><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#F5F5F5"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">    </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    &gt; Entering new SQLDatabaseSequentialChain chain...</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    Table names to use:</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    [&#x27;Employee&#x27;, &#x27;Customer&#x27;]</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    &gt; Entering new SQLDatabaseChain chain...</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    How many employees are also customers?</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    SQLQuery:SELECT COUNT(*) FROM Employee e INNER JOIN Customer c ON e.EmployeeId = c.SupportRepId;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    SQLResult: [(59,)]</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    Answer:59 employees are also customers.</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    &gt; Finished chain.</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    &gt; Finished chain.</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    &#x27;59 employees are also customers.&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="using-local-language-models">Using Local Language Models<a href="#using-local-language-models" class="hash-link" aria-label="Direct link to Using Local Language Models" title="Direct link to Using Local Language Models">​</a></h2><p>Sometimes you may not have the luxury of using OpenAI or other service-hosted large language model. You can, ofcourse, try to use the <code>SQLDatabaseChain</code> with a local model, but will quickly realize that most models you can run locally even with a large GPU struggle to generate the right output.</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#F5F5F5"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">import</span><span class="token plain"> logging</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">import</span><span class="token plain"> torch</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">from</span><span class="token plain"> transformers </span><span class="token keyword" style="color:rgb(0, 0, 255)">import</span><span class="token plain"> AutoTokenizer</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> GPT2TokenizerFast</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> pipeline</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> AutoModelForSeq2SeqLM</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> AutoModelForCausalLM</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">from</span><span class="token plain"> langchain </span><span class="token keyword" style="color:rgb(0, 0, 255)">import</span><span class="token plain"> HuggingFacePipeline</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)"># Note: This model requires a large GPU, e.g. an 80GB A100. See documentation for other ways to run private non-OpenAI models.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">model_id </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;google/flan-ul2&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">model </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> AutoModelForSeq2SeqLM</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">from_pretrained</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">model_id</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> temperature</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">device_id </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token plain">  </span><span class="token comment" style="color:rgb(0, 128, 0)"># default to no-GPU, but use GPU and half precision mode if available</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">if</span><span class="token plain"> torch</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">cuda</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">is_available</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    device_id </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">try</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        model </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> model</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">half</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">except</span><span class="token plain"> RuntimeError </span><span class="token keyword" style="color:rgb(0, 0, 255)">as</span><span class="token plain"> exc</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        logging</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">warn</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string-interpolation string" style="color:rgb(163, 21, 21)">f&quot;Could not run model in half precision mode: </span><span class="token string-interpolation interpolation punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token string-interpolation interpolation builtin" style="color:rgb(0, 112, 193)">str</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string-interpolation interpolation">exc</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token string-interpolation string" style="color:rgb(163, 21, 21)">&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">tokenizer </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> AutoTokenizer</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">from_pretrained</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">model_id</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">pipe </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> pipeline</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">task</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;text2text-generation&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> model</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain">model</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> tokenizer</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain">tokenizer</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> max_length</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token number" style="color:rgb(9, 134, 88)">1024</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> device</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain">device_id</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">local_llm </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> HuggingFacePipeline</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">pipeline</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain">pipe</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div lang="python"><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#F5F5F5"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">    /workspace/langchain/.venv/lib/python3.9/site-packages/tqdm/auto.py:21: TqdmWarning: IProgress not found. Please update jupyter and ipywidgets. See https://ipywidgets.readthedocs.io/en/stable/user_install.html</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      from .autonotebook import tqdm as notebook_tqdm</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    Loading checkpoint shards: 100%|██████████| 8/8 [00:32&lt;00:00,  4.11s/it]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#F5F5F5"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">from</span><span class="token plain"> langchain</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">utilities </span><span class="token keyword" style="color:rgb(0, 0, 255)">import</span><span class="token plain"> SQLDatabase</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">from</span><span class="token plain"> langchain_experimental</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">sql </span><span class="token keyword" style="color:rgb(0, 0, 255)">import</span><span class="token plain"> SQLDatabaseChain</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">db </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> SQLDatabase</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">from_uri</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;sqlite:///../../../../notebooks/Chinook.db&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> include_tables</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;Customer&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">local_chain </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> SQLDatabaseChain</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">from_llm</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">local_llm</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> db</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> verbose</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token boolean">True</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> return_intermediate_steps</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token boolean">True</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> use_query_checker</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token boolean">True</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>This model should work for very simple SQL queries, as long as you use the query checker as specified above, e.g.:</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#F5F5F5"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">local_chain</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;How many customers are there?&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div lang="python"><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#F5F5F5"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">    </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    &gt; Entering new SQLDatabaseChain chain...</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    How many customers are there?</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    SQLQuery:</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    /workspace/langchain/.venv/lib/python3.9/site-packages/transformers/pipelines/base.py:1070: UserWarning: You seem to be using the pipelines sequentially on GPU. In order to maximize efficiency please use a dataset</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      warnings.warn(</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    /workspace/langchain/.venv/lib/python3.9/site-packages/transformers/pipelines/base.py:1070: UserWarning: You seem to be using the pipelines sequentially on GPU. In order to maximize efficiency please use a dataset</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      warnings.warn(</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    SELECT count(*) FROM Customer</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    SQLResult: [(59,)]</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    Answer:</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    /workspace/langchain/.venv/lib/python3.9/site-packages/transformers/pipelines/base.py:1070: UserWarning: You seem to be using the pipelines sequentially on GPU. In order to maximize efficiency please use a dataset</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      warnings.warn(</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    [59]</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    &gt; Finished chain.</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    {&#x27;query&#x27;: &#x27;How many customers are there?&#x27;,</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">     &#x27;result&#x27;: &#x27;[59]&#x27;,</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">     &#x27;intermediate_steps&#x27;: [{&#x27;input&#x27;: &#x27;How many customers are there?\nSQLQuery:SELECT count(*) FROM Customer\nSQLResult: [(59,)]\nAnswer:&#x27;,</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">       &#x27;top_k&#x27;: &#x27;5&#x27;,</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">       &#x27;dialect&#x27;: &#x27;sqlite&#x27;,</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">       &#x27;table_info&#x27;: &#x27;\nCREATE TABLE &quot;Customer&quot; (\n\t&quot;CustomerId&quot; INTEGER NOT NULL, \n\t&quot;FirstName&quot; NVARCHAR(40) NOT NULL, \n\t&quot;LastName&quot; NVARCHAR(20) NOT NULL, \n\t&quot;Company&quot; NVARCHAR(80), \n\t&quot;Address&quot; NVARCHAR(70), \n\t&quot;City&quot; NVARCHAR(40), \n\t&quot;State&quot; NVARCHAR(40), \n\t&quot;Country&quot; NVARCHAR(40), \n\t&quot;PostalCode&quot; NVARCHAR(10), \n\t&quot;Phone&quot; NVARCHAR(24), \n\t&quot;Fax&quot; NVARCHAR(24), \n\t&quot;Email&quot; NVARCHAR(60) NOT NULL, \n\t&quot;SupportRepId&quot; INTEGER, \n\tPRIMARY KEY (&quot;CustomerId&quot;), \n\tFOREIGN KEY(&quot;SupportRepId&quot;) REFERENCES &quot;Employee&quot; (&quot;EmployeeId&quot;)\n)\n\n/*\n3 rows from Customer table:\nCustomerId\tFirstName\tLastName\tCompany\tAddress\tCity\tState\tCountry\tPostalCode\tPhone\tFax\tEmail\tSupportRepId\n1\tLuís\tGonçalves\tEmbraer - Empresa Brasileira de Aeronáutica S.A.\tAv. Brigadeiro Faria Lima, 2170\tSão José dos Campos\tSP\tBrazil\t12227-000\t+55 (12) 3923-5555\t+55 (12) 3923-5566\tluisg@embraer.com.br\t3\n2\tLeonie\tKöhler\tNone\tTheodor-Heuss-Straße 34\tStuttgart\tNone\tGermany\t70174\t+49 0711 2842222\tNone\tleonekohler@surfeu.de\t5\n3\tFrançois\tTremblay\tNone\t1498 rue Bélanger\tMontréal\tQC\tCanada\tH2G 1A7\t+1 (514) 721-4711\tNone\tftremblay@gmail.com\t3\n*/&#x27;,</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">       &#x27;stop&#x27;: [&#x27;\nSQLResult:&#x27;]},</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      &#x27;SELECT count(*) FROM Customer&#x27;,</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      {&#x27;query&#x27;: &#x27;SELECT count(*) FROM Customer&#x27;, &#x27;dialect&#x27;: &#x27;sqlite&#x27;},</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      &#x27;SELECT count(*) FROM Customer&#x27;,</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      &#x27;[(59,)]&#x27;]}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div><p>Even this relatively large model will most likely fail to generate more complicated SQL by itself. However, you can log its inputs and outputs so that you can hand-correct them and use the corrected examples for few-shot prompt examples later. In practice, you could log any executions of your chain that raise exceptions (as shown in the example below) or get direct user feedback in cases where the results are incorrect (but did not raise an exception).</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#F5F5F5"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">poetry run pip </span><span class="token function" style="color:rgb(0, 0, 255)">install</span><span class="token plain"> pyyaml chromadb</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token function" style="color:rgb(0, 0, 255)">import</span><span class="token plain"> yaml</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div lang="bash"><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#F5F5F5"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">    huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    To disable this warning, you can either:</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        - Avoid using `tokenizers` before the fork if possible</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        - Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    11842.36s - pydevd: Sending message related to process being replaced timed-out after 5 seconds</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    Requirement already satisfied: pyyaml in /workspace/langchain/.venv/lib/python3.9/site-packages (6.0)</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    Requirement already satisfied: chromadb in /workspace/langchain/.venv/lib/python3.9/site-packages (0.3.21)</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    Requirement already satisfied: pandas&gt;=1.3 in /workspace/langchain/.venv/lib/python3.9/site-packages (from chromadb) (2.0.1)</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    Requirement already satisfied: requests&gt;=2.28 in /workspace/langchain/.venv/lib/python3.9/site-packages (from chromadb) (2.28.2)</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    Requirement already satisfied: pydantic&gt;=1.9 in /workspace/langchain/.venv/lib/python3.9/site-packages (from chromadb) (1.10.7)</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    Requirement already satisfied: hnswlib&gt;=0.7 in /workspace/langchain/.venv/lib/python3.9/site-packages (from chromadb) (0.7.0)</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    Requirement already satisfied: clickhouse-connect&gt;=0.5.7 in /workspace/langchain/.venv/lib/python3.9/site-packages (from chromadb) (0.5.20)</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    Requirement already satisfied: sentence-transformers&gt;=2.2.2 in /workspace/langchain/.venv/lib/python3.9/site-packages (from chromadb) (2.2.2)</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    Requirement already satisfied: duckdb&gt;=0.7.1 in /workspace/langchain/.venv/lib/python3.9/site-packages (from chromadb) (0.7.1)</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    Requirement already satisfied: fastapi&gt;=0.85.1 in /workspace/langchain/.venv/lib/python3.9/site-packages (from chromadb) (0.95.1)</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    Requirement already satisfied: uvicorn[standard]&gt;=0.18.3 in /workspace/langchain/.venv/lib/python3.9/site-packages (from chromadb) (0.21.1)</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    Requirement already satisfied: numpy&gt;=1.21.6 in /workspace/langchain/.venv/lib/python3.9/site-packages (from chromadb) (1.24.3)</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    Requirement already satisfied: posthog&gt;=2.4.0 in /workspace/langchain/.venv/lib/python3.9/site-packages (from chromadb) (3.0.1)</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    Requirement already satisfied: certifi in /workspace/langchain/.venv/lib/python3.9/site-packages (from clickhouse-connect&gt;=0.5.7-&gt;chromadb) (2022.12.7)</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    Requirement already satisfied: urllib3&gt;=1.26 in /workspace/langchain/.venv/lib/python3.9/site-packages (from clickhouse-connect&gt;=0.5.7-&gt;chromadb) (1.26.15)</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    Requirement already satisfied: pytz in /workspace/langchain/.venv/lib/python3.9/site-packages (from clickhouse-connect&gt;=0.5.7-&gt;chromadb) (2023.3)</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    Requirement already satisfied: zstandard in /workspace/langchain/.venv/lib/python3.9/site-packages (from clickhouse-connect&gt;=0.5.7-&gt;chromadb) (0.21.0)</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    Requirement already satisfied: lz4 in /workspace/langchain/.venv/lib/python3.9/site-packages (from clickhouse-connect&gt;=0.5.7-&gt;chromadb) (4.3.2)</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    Requirement already satisfied: starlette&lt;0.27.0,&gt;=0.26.1 in /workspace/langchain/.venv/lib/python3.9/site-packages (from fastapi&gt;=0.85.1-&gt;chromadb) (0.26.1)</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    Requirement already satisfied: python-dateutil&gt;=2.8.2 in /workspace/langchain/.venv/lib/python3.9/site-packages (from pandas&gt;=1.3-&gt;chromadb) (2.8.2)</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    Requirement already satisfied: tzdata&gt;=2022.1 in /workspace/langchain/.venv/lib/python3.9/site-packages (from pandas&gt;=1.3-&gt;chromadb) (2023.3)</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    Requirement already satisfied: six&gt;=1.5 in /workspace/langchain/.venv/lib/python3.9/site-packages (from posthog&gt;=2.4.0-&gt;chromadb) (1.16.0)</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    Requirement already satisfied: monotonic&gt;=1.5 in /workspace/langchain/.venv/lib/python3.9/site-packages (from posthog&gt;=2.4.0-&gt;chromadb) (1.6)</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    Requirement already satisfied: backoff&gt;=1.10.0 in /workspace/langchain/.venv/lib/python3.9/site-packages (from posthog&gt;=2.4.0-&gt;chromadb) (2.2.1)</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    Requirement already satisfied: typing-extensions&gt;=4.2.0 in /workspace/langchain/.venv/lib/python3.9/site-packages (from pydantic&gt;=1.9-&gt;chromadb) (4.5.0)</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    Requirement already satisfied: charset-normalizer&lt;4,&gt;=2 in /workspace/langchain/.venv/lib/python3.9/site-packages (from requests&gt;=2.28-&gt;chromadb) (3.1.0)</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    Requirement already satisfied: idna&lt;4,&gt;=2.5 in /workspace/langchain/.venv/lib/python3.9/site-packages (from requests&gt;=2.28-&gt;chromadb) (3.4)</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    Requirement already satisfied: transformers&lt;5.0.0,&gt;=4.6.0 in /workspace/langchain/.venv/lib/python3.9/site-packages (from sentence-transformers&gt;=2.2.2-&gt;chromadb) (4.28.1)</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    Requirement already satisfied: tqdm in /workspace/langchain/.venv/lib/python3.9/site-packages (from sentence-transformers&gt;=2.2.2-&gt;chromadb) (4.65.0)</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    Requirement already satisfied: torch&gt;=1.6.0 in /workspace/langchain/.venv/lib/python3.9/site-packages (from sentence-transformers&gt;=2.2.2-&gt;chromadb) (1.13.1)</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    Requirement already satisfied: torchvision in /workspace/langchain/.venv/lib/python3.9/site-packages (from sentence-transformers&gt;=2.2.2-&gt;chromadb) (0.14.1)</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    Requirement already satisfied: scikit-learn in /workspace/langchain/.venv/lib/python3.9/site-packages (from sentence-transformers&gt;=2.2.2-&gt;chromadb) (1.2.2)</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    Requirement already satisfied: scipy in /workspace/langchain/.venv/lib/python3.9/site-packages (from sentence-transformers&gt;=2.2.2-&gt;chromadb) (1.9.3)</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    Requirement already satisfied: nltk in /workspace/langchain/.venv/lib/python3.9/site-packages (from sentence-transformers&gt;=2.2.2-&gt;chromadb) (3.8.1)</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    Requirement already satisfied: sentencepiece in /workspace/langchain/.venv/lib/python3.9/site-packages (from sentence-transformers&gt;=2.2.2-&gt;chromadb) (0.1.98)</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    Requirement already satisfied: huggingface-hub&gt;=0.4.0 in /workspace/langchain/.venv/lib/python3.9/site-packages (from sentence-transformers&gt;=2.2.2-&gt;chromadb) (0.13.4)</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    Requirement already satisfied: click&gt;=7.0 in /workspace/langchain/.venv/lib/python3.9/site-packages (from uvicorn[standard]&gt;=0.18.3-&gt;chromadb) (8.1.3)</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    Requirement already satisfied: h11&gt;=0.8 in /workspace/langchain/.venv/lib/python3.9/site-packages (from uvicorn[standard]&gt;=0.18.3-&gt;chromadb) (0.14.0)</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    Requirement already satisfied: httptools&gt;=0.5.0 in /workspace/langchain/.venv/lib/python3.9/site-packages (from uvicorn[standard]&gt;=0.18.3-&gt;chromadb) (0.5.0)</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    Requirement already satisfied: python-dotenv&gt;=0.13 in /workspace/langchain/.venv/lib/python3.9/site-packages (from uvicorn[standard]&gt;=0.18.3-&gt;chromadb) (1.0.0)</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    Requirement already satisfied: uvloop!=0.15.0,!=0.15.1,&gt;=0.14.0 in /workspace/langchain/.venv/lib/python3.9/site-packages (from uvicorn[standard]&gt;=0.18.3-&gt;chromadb) (0.17.0)</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    Requirement already satisfied: watchfiles&gt;=0.13 in /workspace/langchain/.venv/lib/python3.9/site-packages (from uvicorn[standard]&gt;=0.18.3-&gt;chromadb) (0.19.0)</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    Requirement already satisfied: websockets&gt;=10.4 in /workspace/langchain/.venv/lib/python3.9/site-packages (from uvicorn[standard]&gt;=0.18.3-&gt;chromadb) (11.0.2)</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    Requirement already satisfied: filelock in /workspace/langchain/.venv/lib/python3.9/site-packages (from huggingface-hub&gt;=0.4.0-&gt;sentence-transformers&gt;=2.2.2-&gt;chromadb) (3.12.0)</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    Requirement already satisfied: packaging&gt;=20.9 in /workspace/langchain/.venv/lib/python3.9/site-packages (from huggingface-hub&gt;=0.4.0-&gt;sentence-transformers&gt;=2.2.2-&gt;chromadb) (23.1)</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    Requirement already satisfied: anyio&lt;5,&gt;=3.4.0 in /workspace/langchain/.venv/lib/python3.9/site-packages (from starlette&lt;0.27.0,&gt;=0.26.1-&gt;fastapi&gt;=0.85.1-&gt;chromadb) (3.6.2)</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    Requirement already satisfied: nvidia-cuda-runtime-cu11==11.7.99 in /workspace/langchain/.venv/lib/python3.9/site-packages (from torch&gt;=1.6.0-&gt;sentence-transformers&gt;=2.2.2-&gt;chromadb) (11.7.99)</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    Requirement already satisfied: nvidia-cudnn-cu11==8.5.0.96 in /workspace/langchain/.venv/lib/python3.9/site-packages (from torch&gt;=1.6.0-&gt;sentence-transformers&gt;=2.2.2-&gt;chromadb) (8.5.0.96)</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    Requirement already satisfied: nvidia-cublas-cu11==11.10.3.66 in /workspace/langchain/.venv/lib/python3.9/site-packages (from torch&gt;=1.6.0-&gt;sentence-transformers&gt;=2.2.2-&gt;chromadb) (11.10.3.66)</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    Requirement already satisfied: nvidia-cuda-nvrtc-cu11==11.7.99 in /workspace/langchain/.venv/lib/python3.9/site-packages (from torch&gt;=1.6.0-&gt;sentence-transformers&gt;=2.2.2-&gt;chromadb) (11.7.99)</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    Requirement already satisfied: setuptools in /workspace/langchain/.venv/lib/python3.9/site-packages (from nvidia-cublas-cu11==11.10.3.66-&gt;torch&gt;=1.6.0-&gt;sentence-transformers&gt;=2.2.2-&gt;chromadb) (67.7.1)</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    Requirement already satisfied: wheel in /workspace/langchain/.venv/lib/python3.9/site-packages (from nvidia-cublas-cu11==11.10.3.66-&gt;torch&gt;=1.6.0-&gt;sentence-transformers&gt;=2.2.2-&gt;chromadb) (0.40.0)</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    Requirement already satisfied: regex!=2019.12.17 in /workspace/langchain/.venv/lib/python3.9/site-packages (from transformers&lt;5.0.0,&gt;=4.6.0-&gt;sentence-transformers&gt;=2.2.2-&gt;chromadb) (2023.3.23)</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    Requirement already satisfied: tokenizers!=0.11.3,&lt;0.14,&gt;=0.11.1 in /workspace/langchain/.venv/lib/python3.9/site-packages (from transformers&lt;5.0.0,&gt;=4.6.0-&gt;sentence-transformers&gt;=2.2.2-&gt;chromadb) (0.13.3)</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    Requirement already satisfied: joblib in /workspace/langchain/.venv/lib/python3.9/site-packages (from nltk-&gt;sentence-transformers&gt;=2.2.2-&gt;chromadb) (1.2.0)</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    Requirement already satisfied: threadpoolctl&gt;=2.0.0 in /workspace/langchain/.venv/lib/python3.9/site-packages (from scikit-learn-&gt;sentence-transformers&gt;=2.2.2-&gt;chromadb) (3.1.0)</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    Requirement already satisfied: pillow!=8.3.*,&gt;=5.3.0 in /workspace/langchain/.venv/lib/python3.9/site-packages (from torchvision-&gt;sentence-transformers&gt;=2.2.2-&gt;chromadb) (9.5.0)</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    Requirement already satisfied: sniffio&gt;=1.1 in /workspace/langchain/.venv/lib/python3.9/site-packages (from anyio&lt;5,&gt;=3.4.0-&gt;starlette&lt;0.27.0,&gt;=0.26.1-&gt;fastapi&gt;=0.85.1-&gt;chromadb) (1.3.0)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#F5F5F5"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">from</span><span class="token plain"> typing </span><span class="token keyword" style="color:rgb(0, 0, 255)">import</span><span class="token plain"> Dict</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">QUERY </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;List all the customer first names that start with &#x27;a&#x27;&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">def</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">_parse_example</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">result</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> Dict</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"> Dict</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    sql_cmd_key </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;sql_cmd&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    sql_result_key </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;sql_result&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    table_info_key </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;table_info&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    input_key </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;input&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    final_answer_key </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;answer&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    _example </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;input&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> result</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">get</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;query&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    steps </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> result</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">get</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;intermediate_steps&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    answer_key </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> sql_cmd_key </span><span class="token comment" style="color:rgb(0, 128, 0)"># the first one</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">for</span><span class="token plain"> step </span><span class="token keyword" style="color:rgb(0, 0, 255)">in</span><span class="token plain"> steps</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token comment" style="color:rgb(0, 128, 0)"># The steps are in pairs, a dict (input) followed by a string (output).</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token comment" style="color:rgb(0, 128, 0)"># Unfortunately there is no schema but you can look at the input key of the</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token comment" style="color:rgb(0, 128, 0)"># dict to see what the output is supposed to be</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">if</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(0, 112, 193)">isinstance</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">step</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(0, 112, 193)">dict</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token comment" style="color:rgb(0, 128, 0)"># Grab the table info from input dicts in the intermediate steps once</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token keyword" style="color:rgb(0, 0, 255)">if</span><span class="token plain"> table_info_key </span><span class="token keyword" style="color:rgb(0, 0, 255)">not</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">in</span><span class="token plain"> _example</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                _example</span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">table_info_key</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> step</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">get</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">table_info_key</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token keyword" style="color:rgb(0, 0, 255)">if</span><span class="token plain"> input_key </span><span class="token keyword" style="color:rgb(0, 0, 255)">in</span><span class="token plain"> step</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                </span><span class="token keyword" style="color:rgb(0, 0, 255)">if</span><span class="token plain"> step</span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">input_key</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">endswith</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;SQLQuery:&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                    answer_key </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> sql_cmd_key </span><span class="token comment" style="color:rgb(0, 128, 0)"># this is the SQL generation input</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                </span><span class="token keyword" style="color:rgb(0, 0, 255)">if</span><span class="token plain"> step</span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">input_key</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">endswith</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;Answer:&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                    answer_key </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> final_answer_key </span><span class="token comment" style="color:rgb(0, 128, 0)"># this is the final answer input</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token keyword" style="color:rgb(0, 0, 255)">elif</span><span class="token plain"> sql_cmd_key </span><span class="token keyword" style="color:rgb(0, 0, 255)">in</span><span class="token plain"> step</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                _example</span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">sql_cmd_key</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> step</span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">sql_cmd_key</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                answer_key </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> sql_result_key </span><span class="token comment" style="color:rgb(0, 128, 0)"># this is SQL execution input</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">elif</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(0, 112, 193)">isinstance</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">step</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(0, 112, 193)">str</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token comment" style="color:rgb(0, 128, 0)"># The preceding element should have set the answer_key</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            _example</span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">answer_key</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> step</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">return</span><span class="token plain"> _example</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">example</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(0, 112, 193)">any</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">try</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    result </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> local_chain</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">QUERY</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">print</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;*** Query succeeded&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    example </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> _parse_example</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">result</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">except</span><span class="token plain"> Exception </span><span class="token keyword" style="color:rgb(0, 0, 255)">as</span><span class="token plain"> exc</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">print</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;*** Query failed&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    result </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;query&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> QUERY</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;intermediate_steps&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> exc</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">intermediate_steps</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    example </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> _parse_example</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">result</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)"># print for now, in reality you may want to write this out to a YAML file or database for manual fix-ups offline</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">yaml_example </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> yaml</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">dump</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">example</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> allow_unicode</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token boolean">True</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">print</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;\n&quot;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">+</span><span class="token plain"> yaml_example</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div lang="python"><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#F5F5F5"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">    </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    &gt; Entering new SQLDatabaseChain chain...</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    List all the customer first names that start with &#x27;a&#x27;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    SQLQuery:</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    /workspace/langchain/.venv/lib/python3.9/site-packages/transformers/pipelines/base.py:1070: UserWarning: You seem to be using the pipelines sequentially on GPU. In order to maximize efficiency please use a dataset</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      warnings.warn(</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    SELECT firstname FROM customer WHERE firstname LIKE &#x27;%a%&#x27;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    SQLResult: [(&#x27;François&#x27;,), (&#x27;František&#x27;,), (&#x27;Helena&#x27;,), (&#x27;Astrid&#x27;,), (&#x27;Daan&#x27;,), (&#x27;Kara&#x27;,), (&#x27;Eduardo&#x27;,), (&#x27;Alexandre&#x27;,), (&#x27;Fernanda&#x27;,), (&#x27;Mark&#x27;,), (&#x27;Frank&#x27;,), (&#x27;Jack&#x27;,), (&#x27;Dan&#x27;,), (&#x27;Kathy&#x27;,), (&#x27;Heather&#x27;,), (&#x27;Frank&#x27;,), (&#x27;Richard&#x27;,), (&#x27;Patrick&#x27;,), (&#x27;Julia&#x27;,), (&#x27;Edward&#x27;,), (&#x27;Martha&#x27;,), (&#x27;Aaron&#x27;,), (&#x27;Madalena&#x27;,), (&#x27;Hannah&#x27;,), (&#x27;Niklas&#x27;,), (&#x27;Camille&#x27;,), (&#x27;Marc&#x27;,), (&#x27;Wyatt&#x27;,), (&#x27;Isabelle&#x27;,), (&#x27;Ladislav&#x27;,), (&#x27;Lucas&#x27;,), (&#x27;Johannes&#x27;,), (&#x27;Stanisław&#x27;,), (&#x27;Joakim&#x27;,), (&#x27;Emma&#x27;,), (&#x27;Mark&#x27;,), (&#x27;Manoj&#x27;,), (&#x27;Puja&#x27;,)]</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    Answer:</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    /workspace/langchain/.venv/lib/python3.9/site-packages/transformers/pipelines/base.py:1070: UserWarning: You seem to be using the pipelines sequentially on GPU. In order to maximize efficiency please use a dataset</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      warnings.warn(</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    [(&#x27;François&#x27;, &#x27;Frantiek&#x27;, &#x27;Helena&#x27;, &#x27;Astrid&#x27;, &#x27;Daan&#x27;, &#x27;Kara&#x27;, &#x27;Eduardo&#x27;, &#x27;Alexandre&#x27;, &#x27;Fernanda&#x27;, &#x27;Mark&#x27;, &#x27;Frank&#x27;, &#x27;Jack&#x27;, &#x27;Dan&#x27;, &#x27;Kathy&#x27;, &#x27;Heather&#x27;, &#x27;Frank&#x27;, &#x27;Richard&#x27;, &#x27;Patrick&#x27;, &#x27;Julia&#x27;, &#x27;Edward&#x27;, &#x27;Martha&#x27;, &#x27;Aaron&#x27;, &#x27;Madalena&#x27;, &#x27;Hannah&#x27;, &#x27;Niklas&#x27;, &#x27;Camille&#x27;, &#x27;Marc&#x27;, &#x27;Wyatt&#x27;, &#x27;Isabelle&#x27;, &#x27;Ladislav&#x27;, &#x27;Lucas&#x27;, &#x27;Johannes&#x27;, &#x27;Stanisaw&#x27;, &#x27;Joakim&#x27;, &#x27;Emma&#x27;, &#x27;Mark&#x27;, &#x27;Manoj&#x27;, &#x27;Puja&#x27;]</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    &gt; Finished chain.</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    *** Query succeeded</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    answer: &#x27;[(&#x27;&#x27;François&#x27;&#x27;, &#x27;&#x27;Frantiek&#x27;&#x27;, &#x27;&#x27;Helena&#x27;&#x27;, &#x27;&#x27;Astrid&#x27;&#x27;, &#x27;&#x27;Daan&#x27;&#x27;, &#x27;&#x27;Kara&#x27;&#x27;,</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      &#x27;&#x27;Eduardo&#x27;&#x27;, &#x27;&#x27;Alexandre&#x27;&#x27;, &#x27;&#x27;Fernanda&#x27;&#x27;, &#x27;&#x27;Mark&#x27;&#x27;, &#x27;&#x27;Frank&#x27;&#x27;, &#x27;&#x27;Jack&#x27;&#x27;, &#x27;&#x27;Dan&#x27;&#x27;,</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      &#x27;&#x27;Kathy&#x27;&#x27;, &#x27;&#x27;Heather&#x27;&#x27;, &#x27;&#x27;Frank&#x27;&#x27;, &#x27;&#x27;Richard&#x27;&#x27;, &#x27;&#x27;Patrick&#x27;&#x27;, &#x27;&#x27;Julia&#x27;&#x27;, &#x27;&#x27;Edward&#x27;&#x27;,</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      &#x27;&#x27;Martha&#x27;&#x27;, &#x27;&#x27;Aaron&#x27;&#x27;, &#x27;&#x27;Madalena&#x27;&#x27;, &#x27;&#x27;Hannah&#x27;&#x27;, &#x27;&#x27;Niklas&#x27;&#x27;, &#x27;&#x27;Camille&#x27;&#x27;, &#x27;&#x27;Marc&#x27;&#x27;,</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      &#x27;&#x27;Wyatt&#x27;&#x27;, &#x27;&#x27;Isabelle&#x27;&#x27;, &#x27;&#x27;Ladislav&#x27;&#x27;, &#x27;&#x27;Lucas&#x27;&#x27;, &#x27;&#x27;Johannes&#x27;&#x27;, &#x27;&#x27;Stanisaw&#x27;&#x27;, &#x27;&#x27;Joakim&#x27;&#x27;,</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      &#x27;&#x27;Emma&#x27;&#x27;, &#x27;&#x27;Mark&#x27;&#x27;, &#x27;&#x27;Manoj&#x27;&#x27;, &#x27;&#x27;Puja&#x27;&#x27;]&#x27;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    input: List all the customer first names that start with &#x27;a&#x27;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    sql_cmd: SELECT firstname FROM customer WHERE firstname LIKE &#x27;%a%&#x27;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    sql_result: &#x27;[(&#x27;&#x27;François&#x27;&#x27;,), (&#x27;&#x27;František&#x27;&#x27;,), (&#x27;&#x27;Helena&#x27;&#x27;,), (&#x27;&#x27;Astrid&#x27;&#x27;,), (&#x27;&#x27;Daan&#x27;&#x27;,),</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      (&#x27;&#x27;Kara&#x27;&#x27;,), (&#x27;&#x27;Eduardo&#x27;&#x27;,), (&#x27;&#x27;Alexandre&#x27;&#x27;,), (&#x27;&#x27;Fernanda&#x27;&#x27;,), (&#x27;&#x27;Mark&#x27;&#x27;,), (&#x27;&#x27;Frank&#x27;&#x27;,),</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      (&#x27;&#x27;Jack&#x27;&#x27;,), (&#x27;&#x27;Dan&#x27;&#x27;,), (&#x27;&#x27;Kathy&#x27;&#x27;,), (&#x27;&#x27;Heather&#x27;&#x27;,), (&#x27;&#x27;Frank&#x27;&#x27;,), (&#x27;&#x27;Richard&#x27;&#x27;,),</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      (&#x27;&#x27;Patrick&#x27;&#x27;,), (&#x27;&#x27;Julia&#x27;&#x27;,), (&#x27;&#x27;Edward&#x27;&#x27;,), (&#x27;&#x27;Martha&#x27;&#x27;,), (&#x27;&#x27;Aaron&#x27;&#x27;,), (&#x27;&#x27;Madalena&#x27;&#x27;,),</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      (&#x27;&#x27;Hannah&#x27;&#x27;,), (&#x27;&#x27;Niklas&#x27;&#x27;,), (&#x27;&#x27;Camille&#x27;&#x27;,), (&#x27;&#x27;Marc&#x27;&#x27;,), (&#x27;&#x27;Wyatt&#x27;&#x27;,), (&#x27;&#x27;Isabelle&#x27;&#x27;,),</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      (&#x27;&#x27;Ladislav&#x27;&#x27;,), (&#x27;&#x27;Lucas&#x27;&#x27;,), (&#x27;&#x27;Johannes&#x27;&#x27;,), (&#x27;&#x27;Stanisław&#x27;&#x27;,), (&#x27;&#x27;Joakim&#x27;&#x27;,),</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      (&#x27;&#x27;Emma&#x27;&#x27;,), (&#x27;&#x27;Mark&#x27;&#x27;,), (&#x27;&#x27;Manoj&#x27;&#x27;,), (&#x27;&#x27;Puja&#x27;&#x27;,)]&#x27;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    table_info: &quot;\nCREATE TABLE \&quot;Customer\&quot; (\n\t\&quot;CustomerId\&quot; INTEGER NOT NULL, \n\t\</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      \&quot;FirstName\&quot; NVARCHAR(40) NOT NULL, \n\t\&quot;LastName\&quot; NVARCHAR(20) NOT NULL, \n\t\</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      \&quot;Company\&quot; NVARCHAR(80), \n\t\&quot;Address\&quot; NVARCHAR(70), \n\t\&quot;City\&quot; NVARCHAR(40),\</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      \ \n\t\&quot;State\&quot; NVARCHAR(40), \n\t\&quot;Country\&quot; NVARCHAR(40), \n\t\&quot;PostalCode\&quot; NVARCHAR(10),\</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      \ \n\t\&quot;Phone\&quot; NVARCHAR(24), \n\t\&quot;Fax\&quot; NVARCHAR(24), \n\t\&quot;Email\&quot; NVARCHAR(60)\</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      \ NOT NULL, \n\t\&quot;SupportRepId\&quot; INTEGER, \n\tPRIMARY KEY (\&quot;CustomerId\&quot;), \n\t\</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      FOREIGN KEY(\&quot;SupportRepId\&quot;) REFERENCES \&quot;Employee\&quot; (\&quot;EmployeeId\&quot;)\n)\n\n/*\n\</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      3 rows from Customer table:\nCustomerId\tFirstName\tLastName\tCompany\tAddress\t\</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      City\tState\tCountry\tPostalCode\tPhone\tFax\tEmail\tSupportRepId\n1\tLuís\tGonçalves\t\</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      Embraer - Empresa Brasileira de Aeronáutica S.A.\tAv. Brigadeiro Faria Lima, 2170\t\</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      São José dos Campos\tSP\tBrazil\t12227-000\t+55 (12) 3923-5555\t+55 (12) 3923-5566\t\</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      luisg@embraer.com.br\t3\n2\tLeonie\tKöhler\tNone\tTheodor-Heuss-Straße 34\tStuttgart\t\</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      None\tGermany\t70174\t+49 0711 2842222\tNone\tleonekohler@surfeu.de\t5\n3\tFrançois\t\</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      Tremblay\tNone\t1498 rue Bélanger\tMontréal\tQC\tCanada\tH2G 1A7\t+1 (514) 721-4711\t\</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      None\tftremblay@gmail.com\t3\n*/&quot;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div><p>Run the snippet above a few times, or log exceptions in your deployed environment, to collect lots of examples of inputs, table_info and sql_cmd generated by your language model. The sql_cmd values will be incorrect and you can manually fix them up to build a collection of examples, e.g. here we are using YAML to keep a neat record of our inputs and corrected SQL output that we can build up over time.</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#F5F5F5"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">YAML_EXAMPLES </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token triple-quoted-string string" style="color:rgb(163, 21, 21)">&quot;&quot;&quot;</span><br></span><span class="token-line" style="color:#000000"><span class="token triple-quoted-string string" style="color:rgb(163, 21, 21)">- input: How many customers are not from Brazil?</span><br></span><span class="token-line" style="color:#000000"><span class="token triple-quoted-string string" style="color:rgb(163, 21, 21)">  table_info: |</span><br></span><span class="token-line" style="color:#000000"><span class="token triple-quoted-string string" style="color:rgb(163, 21, 21)">    CREATE TABLE &quot;Customer&quot; (</span><br></span><span class="token-line" style="color:#000000"><span class="token triple-quoted-string string" style="color:rgb(163, 21, 21)">      &quot;CustomerId&quot; INTEGER NOT NULL, </span><br></span><span class="token-line" style="color:#000000"><span class="token triple-quoted-string string" style="color:rgb(163, 21, 21)">      &quot;FirstName&quot; NVARCHAR(40) NOT NULL, </span><br></span><span class="token-line" style="color:#000000"><span class="token triple-quoted-string string" style="color:rgb(163, 21, 21)">      &quot;LastName&quot; NVARCHAR(20) NOT NULL, </span><br></span><span class="token-line" style="color:#000000"><span class="token triple-quoted-string string" style="color:rgb(163, 21, 21)">      &quot;Company&quot; NVARCHAR(80), </span><br></span><span class="token-line" style="color:#000000"><span class="token triple-quoted-string string" style="color:rgb(163, 21, 21)">      &quot;Address&quot; NVARCHAR(70), </span><br></span><span class="token-line" style="color:#000000"><span class="token triple-quoted-string string" style="color:rgb(163, 21, 21)">      &quot;City&quot; NVARCHAR(40), </span><br></span><span class="token-line" style="color:#000000"><span class="token triple-quoted-string string" style="color:rgb(163, 21, 21)">      &quot;State&quot; NVARCHAR(40), </span><br></span><span class="token-line" style="color:#000000"><span class="token triple-quoted-string string" style="color:rgb(163, 21, 21)">      &quot;Country&quot; NVARCHAR(40), </span><br></span><span class="token-line" style="color:#000000"><span class="token triple-quoted-string string" style="color:rgb(163, 21, 21)">      &quot;PostalCode&quot; NVARCHAR(10), </span><br></span><span class="token-line" style="color:#000000"><span class="token triple-quoted-string string" style="color:rgb(163, 21, 21)">      &quot;Phone&quot; NVARCHAR(24), </span><br></span><span class="token-line" style="color:#000000"><span class="token triple-quoted-string string" style="color:rgb(163, 21, 21)">      &quot;Fax&quot; NVARCHAR(24), </span><br></span><span class="token-line" style="color:#000000"><span class="token triple-quoted-string string" style="color:rgb(163, 21, 21)">      &quot;Email&quot; NVARCHAR(60) NOT NULL, </span><br></span><span class="token-line" style="color:#000000"><span class="token triple-quoted-string string" style="color:rgb(163, 21, 21)">      &quot;SupportRepId&quot; INTEGER, </span><br></span><span class="token-line" style="color:#000000"><span class="token triple-quoted-string string" style="color:rgb(163, 21, 21)">      PRIMARY KEY (&quot;CustomerId&quot;), </span><br></span><span class="token-line" style="color:#000000"><span class="token triple-quoted-string string" style="color:rgb(163, 21, 21)">      FOREIGN KEY(&quot;SupportRepId&quot;) REFERENCES &quot;Employee&quot; (&quot;EmployeeId&quot;)</span><br></span><span class="token-line" style="color:#000000"><span class="token triple-quoted-string string" style="color:rgb(163, 21, 21)">    )</span><br></span><span class="token-line" style="color:#000000"><span class="token triple-quoted-string string" style="color:rgb(163, 21, 21)">  sql_cmd: SELECT COUNT(*) FROM &quot;Customer&quot; WHERE NOT &quot;Country&quot; = &quot;Brazil&quot;;</span><br></span><span class="token-line" style="color:#000000"><span class="token triple-quoted-string string" style="color:rgb(163, 21, 21)">  sql_result: &quot;[(54,)]&quot;</span><br></span><span class="token-line" style="color:#000000"><span class="token triple-quoted-string string" style="color:rgb(163, 21, 21)">  answer: 54 customers are not from Brazil.</span><br></span><span class="token-line" style="color:#000000"><span class="token triple-quoted-string string" style="color:rgb(163, 21, 21)">- input: list all the genres that start with &#x27;r&#x27;</span><br></span><span class="token-line" style="color:#000000"><span class="token triple-quoted-string string" style="color:rgb(163, 21, 21)">  table_info: |</span><br></span><span class="token-line" style="color:#000000"><span class="token triple-quoted-string string" style="color:rgb(163, 21, 21)">    CREATE TABLE &quot;Genre&quot; (</span><br></span><span class="token-line" style="color:#000000"><span class="token triple-quoted-string string" style="color:rgb(163, 21, 21)">      &quot;GenreId&quot; INTEGER NOT NULL, </span><br></span><span class="token-line" style="color:#000000"><span class="token triple-quoted-string string" style="color:rgb(163, 21, 21)">      &quot;Name&quot; NVARCHAR(120), </span><br></span><span class="token-line" style="color:#000000"><span class="token triple-quoted-string string" style="color:rgb(163, 21, 21)">      PRIMARY KEY (&quot;GenreId&quot;)</span><br></span><span class="token-line" style="color:#000000"><span class="token triple-quoted-string string" style="color:rgb(163, 21, 21)">    )</span><br></span><span class="token-line" style="color:#000000"><span class="token triple-quoted-string string" style="display:inline-block;color:rgb(163, 21, 21)"></span><br></span><span class="token-line" style="color:#000000"><span class="token triple-quoted-string string" style="color:rgb(163, 21, 21)">    /*</span><br></span><span class="token-line" style="color:#000000"><span class="token triple-quoted-string string" style="color:rgb(163, 21, 21)">    3 rows from Genre table:</span><br></span><span class="token-line" style="color:#000000"><span class="token triple-quoted-string string" style="color:rgb(163, 21, 21)">    GenreId Name</span><br></span><span class="token-line" style="color:#000000"><span class="token triple-quoted-string string" style="color:rgb(163, 21, 21)">    1   Rock</span><br></span><span class="token-line" style="color:#000000"><span class="token triple-quoted-string string" style="color:rgb(163, 21, 21)">    2   Jazz</span><br></span><span class="token-line" style="color:#000000"><span class="token triple-quoted-string string" style="color:rgb(163, 21, 21)">    3   Metal</span><br></span><span class="token-line" style="color:#000000"><span class="token triple-quoted-string string" style="color:rgb(163, 21, 21)">    */</span><br></span><span class="token-line" style="color:#000000"><span class="token triple-quoted-string string" style="color:rgb(163, 21, 21)">  sql_cmd: SELECT &quot;Name&quot; FROM &quot;Genre&quot; WHERE &quot;Name&quot; LIKE &#x27;r%&#x27;;</span><br></span><span class="token-line" style="color:#000000"><span class="token triple-quoted-string string" style="color:rgb(163, 21, 21)">  sql_result: &quot;[(&#x27;Rock&#x27;,), (&#x27;Rock and Roll&#x27;,), (&#x27;Reggae&#x27;,), (&#x27;R&amp;B/Soul&#x27;,)]&quot;</span><br></span><span class="token-line" style="color:#000000"><span class="token triple-quoted-string string" style="color:rgb(163, 21, 21)">  answer: The genres that start with &#x27;r&#x27; are Rock, Rock and Roll, Reggae and R&amp;B/Soul. </span><br></span><span class="token-line" style="color:#000000"><span class="token triple-quoted-string string" style="color:rgb(163, 21, 21)">&quot;&quot;&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Now that you have some examples (with manually corrected output SQL), you can do few-shot prompt seeding the usual way:</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#F5F5F5"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">from</span><span class="token plain"> langchain </span><span class="token keyword" style="color:rgb(0, 0, 255)">import</span><span class="token plain"> FewShotPromptTemplate</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> PromptTemplate</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">from</span><span class="token plain"> langchain</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">chains</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">sql_database</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">prompt </span><span class="token keyword" style="color:rgb(0, 0, 255)">import</span><span class="token plain"> _sqlite_prompt</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> PROMPT_SUFFIX</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">from</span><span class="token plain"> langchain</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">embeddings</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">huggingface </span><span class="token keyword" style="color:rgb(0, 0, 255)">import</span><span class="token plain"> HuggingFaceEmbeddings</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">from</span><span class="token plain"> langchain</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">prompts</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">example_selector</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">semantic_similarity </span><span class="token keyword" style="color:rgb(0, 0, 255)">import</span><span class="token plain"> SemanticSimilarityExampleSelector</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">from</span><span class="token plain"> langchain</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">vectorstores </span><span class="token keyword" style="color:rgb(0, 0, 255)">import</span><span class="token plain"> Chroma</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">example_prompt </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> PromptTemplate</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    input_variables</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;table_info&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;input&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;sql_cmd&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;sql_result&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;answer&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    template</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;{table_info}\n\nQuestion: {input}\nSQLQuery: {sql_cmd}\nSQLResult: {sql_result}\nAnswer: {answer}&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">examples_dict </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> yaml</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">safe_load</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">YAML_EXAMPLES</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">local_embeddings </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> HuggingFaceEmbeddings</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">model_name</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;sentence-transformers/all-MiniLM-L6-v2&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">example_selector </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> SemanticSimilarityExampleSelector</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">from_examples</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                        </span><span class="token comment" style="color:rgb(0, 128, 0)"># This is the list of examples available to select from.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                        examples_dict</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                        </span><span class="token comment" style="color:rgb(0, 128, 0)"># This is the embedding class used to produce embeddings which are used to measure semantic similarity.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                        local_embeddings</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                        </span><span class="token comment" style="color:rgb(0, 128, 0)"># This is the VectorStore class that is used to store the embeddings and do a similarity search over.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                        Chroma</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain">  </span><span class="token comment" style="color:rgb(0, 128, 0)"># type: ignore</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                        </span><span class="token comment" style="color:rgb(0, 128, 0)"># This is the number of examples to produce and include per prompt</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                        k</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token builtin" style="color:rgb(0, 112, 193)">min</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token number" style="color:rgb(9, 134, 88)">3</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(0, 112, 193)">len</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">examples_dict</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">few_shot_prompt </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> FewShotPromptTemplate</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    example_selector</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain">example_selector</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    example_prompt</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain">example_prompt</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    prefix</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain">_sqlite_prompt </span><span class="token operator" style="color:rgb(0, 0, 0)">+</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;Here are some examples:&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    suffix</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain">PROMPT_SUFFIX</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    input_variables</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;table_info&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;input&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;top_k&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div lang="python"><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#F5F5F5"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">    Using embedded DuckDB without persistence: data will be transient</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div><p>The model should do better now with this few-shot prompt, especially for inputs similar to the examples you have seeded it with.</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#F5F5F5"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">local_chain </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> SQLDatabaseChain</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">from_llm</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">local_llm</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> db</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> prompt</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain">few_shot_prompt</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> use_query_checker</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token boolean">True</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> verbose</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token boolean">True</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> return_intermediate_steps</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token boolean">True</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#F5F5F5"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">result </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> local_chain</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;How many customers are from Brazil?&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div lang="python"><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#F5F5F5"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">    </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    &gt; Entering new SQLDatabaseChain chain...</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    How many customers are from Brazil?</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    SQLQuery:SELECT count(*) FROM Customer WHERE Country = &quot;Brazil&quot;;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    SQLResult: [(5,)]</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    Answer:[5]</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    &gt; Finished chain.</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#F5F5F5"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">result </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> local_chain</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;How many customers are not from Brazil?&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div lang="python"><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#F5F5F5"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">    </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    &gt; Entering new SQLDatabaseChain chain...</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    How many customers are not from Brazil?</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    SQLQuery:SELECT count(*) FROM customer WHERE country NOT IN (SELECT country FROM customer WHERE country = &#x27;Brazil&#x27;)</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    SQLResult: [(54,)]</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    Answer:54 customers are not from Brazil.</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    &gt; Finished chain.</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#F5F5F5"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">result </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> local_chain</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;How many customers are there in total?&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div lang="python"><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#F5F5F5"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">    </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    &gt; Entering new SQLDatabaseChain chain...</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    How many customers are there in total?</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    SQLQuery:SELECT count(*) FROM Customer;</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    SQLResult: [(59,)]</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    Answer:There are 59 customers in total.</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    &gt; Finished chain.</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/langchain/docs/integrations/tools/serpapi"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">SerpAPI</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/langchain/docs/integrations/tools/twilio"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Twilio</div></a></nav></div></div></div></div></main></div></div><footer class="footer"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://discord.gg/cU2adEyC7w" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://twitter.com/LangChainAI" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">GitHub</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/hwchase17/langchain" target="_blank" rel="noopener noreferrer" class="footer__link-item">Python<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://github.com/hwchase17/langchainjs" target="_blank" rel="noopener noreferrer" class="footer__link-item">JS/TS<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://langchain.com" target="_blank" rel="noopener noreferrer" class="footer__link-item">Homepage<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://blog.langchain.dev" target="_blank" rel="noopener noreferrer" class="footer__link-item">Blog<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2023 LangChain, Inc.</div></div></div></footer></div>
<script src="/langchain/assets/js/runtime~main.96bce49c.js"></script>
<script src="/langchain/assets/js/main.581eebae.js"></script>
</body>
</html>